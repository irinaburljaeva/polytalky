<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>English Intro ‚Äî –£—Ä–æ–∫ 7</title>
  <base href="/">
  <link rel="icon" type="image/jpg" href="/assets/favicon.jpg">

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∫—É—Ä—Å–∞ English Intro -->
  <link rel="stylesheet" href="/courses/english-intro/english-intro.css">

  <!-- Firebase init -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { getFirestore } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBAU_uMTePpKwVNZNhqk2pss2PuSitGfQI",
      authDomain: "polytalky-70999.firebaseapp.com",
      projectId: "polytalky-70999",
      storageBucket: "polytalky-70999.firebasestorage.app",
      messagingSenderId: "62407152289",
      appId: "1:62407152289:web:b0c0efdb2472f12b10d6e0"
    };

    window.firebaseApp  = initializeApp(firebaseConfig);
    window.firebaseAuth = getAuth(window.firebaseApp);
    window.firebaseDb   = getFirestore(window.firebaseApp);
  </script>

  <style>
    .hidden{display:none;}

    /* –°—Ö–µ–º–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è */
    .sentence-scheme {
      background: linear-gradient(135deg, #FFF8E5 0%, #FFE8B3 100%);
      border: 3px solid #FFDE59;
      border-radius: 20px;
      padding: 30px;
      margin: 30px 0;
      box-shadow: 0 10px 30px rgba(255, 159, 28, 0.2);
    }

    .sentence-scheme h3 {
      color: #92400e;
      font-size: 1.4em;
      margin-bottom: 20px;
      font-weight: 700;
      text-align: center;
    }

    .scheme-parts {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      justify-content: center;
      align-items: center;
      margin: 20px 0;
    }

    .scheme-part {
      background: white;
      border: 2px solid #FFD4A8;
      border-radius: 12px;
      padding: 15px 20px;
      font-weight: 600;
      font-size: 1em;
      text-align: center;
      min-width: 120px;
      transition: all 0.3s ease;
    }

    .scheme-part.subject {
      background: linear-gradient(135deg, #FFE8B3, #FFD89B);
      color: #78350f;
    }

    .scheme-part.auxiliary {
      background: linear-gradient(135deg, #FFDE59, #FFBA08);
      color: #78350f;
    }

    .scheme-part.not {
      background: linear-gradient(135deg, #FFD4A8, #FFB48F);
      color: #78350f;
      font-size: 1.2em;
    }

    .scheme-part.verb {
      background: linear-gradient(135deg, #FF9F1C, #FF8A5C);
      color: white;
    }

    .scheme-part.other {
      background: linear-gradient(135deg, #FFF8E5, #FFFDF4);
      color: #78350f;
    }

    .scheme-arrow {
      font-size: 1.5em;
      color: #FF9F1C;
      font-weight: bold;
    }

    /* –°–ø–∏—Å–æ–∫ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã—Ö –≥–ª–∞–≥–æ–ª–æ–≤ */
    .modal-verbs-box {
      background: linear-gradient(135deg, #FFE4E6 0%, #FFF1F2 100%);
      border: 2px solid #FFD4A8;
      border-radius: 16px;
      padding: 25px;
      margin: 25px 0;
      box-shadow: 0 8px 24px rgba(255, 159, 28, 0.15);
    }

    .modal-verbs-box h4 {
      color: #92400e;
      font-size: 1.2em;
      margin-bottom: 15px;
      font-weight: 700;
    }

    .modal-verbs-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 12px;
      margin-top: 15px;
    }

    .modal-verb-item {
      background: white;
      border: 2px solid #FFE8B3;
      border-radius: 10px;
      padding: 12px 15px;
      font-size: 0.95em;
      color: #78350f;
      transition: all 0.2s ease;
    }

    .modal-verb-item:hover {
      background: linear-gradient(135deg, #FFF8E5, #FFE8B3);
      border-color: #FFDE59;
      transform: translateY(-2px);
    }

    .modal-verb-item strong {
      color: #FF9F1C;
      font-size: 1.1em;
    }

    /* –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ - –≤—ã–±–æ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ */
    .exercise-choice {
      background: white;
      border: 2px solid #FFE8B3;
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 20px;
      transition: all 0.3s ease;
    }

    .exercise-choice.correct {
      background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
      border-color: #22c55e;
    }

    .exercise-choice.incorrect {
      background: linear-gradient(135deg, #fff1f2 0%, #ffe4e6 100%);
      border-color: #ef4444;
    }

    .exercise-question {
      font-size: 1.1em;
      color: #78350f;
      margin-bottom: 15px;
      font-weight: 600;
    }

    .choice-options {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .choice-btn {
      background: linear-gradient(135deg, #FFF8E5, #FFFDF4);
      border: 2px solid #FFE8B3;
      border-radius: 12px;
      padding: 12px 20px;
      font-size: 1em;
      color: #78350f;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: left;
      font-weight: 500;
    }

    .choice-btn:hover:not(:disabled) {
      background: linear-gradient(135deg, #FFE8B3, #FFD89B);
      border-color: #FFDE59;
      transform: translateX(5px);
    }

    .choice-btn.selected {
      background: linear-gradient(135deg, #FFDE59, #FFBA08);
      border-color: #FF9F1C;
      color: #78350f;
      font-weight: 600;
    }

    .choice-btn.correct {
      background: linear-gradient(135deg, #d1fae5, #a7f3d0);
      border-color: #22c55e;
      color: #166534;
    }

    .choice-btn.incorrect {
      background: linear-gradient(135deg, #fecaca, #fca5a5);
      border-color: #ef4444;
      color: #991b1b;
    }

    .choice-btn:disabled {
      cursor: not-allowed;
      opacity: 0.8;
    }

    /* –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ - –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π */
    .writing-exercise {
      background: linear-gradient(135deg, #FFF8E5 0%, #FFFDF4 100%);
      border: 2px solid #FFE8B3;
      border-radius: 16px;
      padding: 25px;
      margin: 25px 0;
    }

    .writing-prompt {
      background: white;
      border-left: 4px solid #FF9F1C;
      border-radius: 8px;
      padding: 15px 20px;
      margin-bottom: 15px;
      font-size: 1em;
      color: #78350f;
      line-height: 1.6;
    }

    .sentence-textarea {
      width: 100%;
      min-height: 120px;
      border: 2px solid #FFE8B3;
      border-radius: 12px;
      padding: 15px;
      font-size: 1em;
      color: #78350f;
      resize: vertical;
      transition: all 0.3s ease;
      background: white;
    }

    .sentence-textarea:focus {
      outline: none;
      border-color: #FF9F1C;
      box-shadow: 0 4px 12px rgba(255, 159, 28, 0.2);
    }

    .submit-btn {
      background: linear-gradient(135deg, #FF9F1C 0%, #FFDE59 100%);
      color: #78350f;
      border: none;
      padding: 12px 30px;
      border-radius: 999px;
      font-size: 1em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 8px 20px rgba(255, 159, 28, 0.3);
      margin-top: 15px;
    }

    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 28px rgba(255, 159, 28, 0.4);
    }

    .submit-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .feedback-message {
      margin-top: 15px;
      padding: 15px 20px;
      border-radius: 12px;
      font-size: 0.95em;
      font-weight: 500;
      display: none;
    }

    .feedback-message.show {
      display: block;
      animation: slideIn 0.4s ease;
    }

    .feedback-message.success {
      background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
      border-left: 4px solid #22c55e;
      color: #166534;
    }

    .feedback-message.info {
      background: linear-gradient(135deg, #FFF8E5 0%, #FFE8B3 100%);
      border-left: 4px solid #FFDE59;
      color: #78350f;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .pro-badge {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      background: linear-gradient(135deg, #FFDE59, #FFBA08);
      color: #78350f;
      padding: 4px 12px;
      border-radius: 999px;
      font-size: 0.75em;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    @media (max-width: 768px) {
      .scheme-parts {
        flex-direction: column;
      }

      .scheme-arrow {
        transform: rotate(90deg);
      }

      .scheme-part {
        min-width: 100%;
      }

      .modal-verbs-list {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
 
<!-- –§–æ–Ω–æ–≤—ã–µ –±—É–∫–≤—ã -->
<div class="bg-letter a">D</div>
<div class="bg-letter e">O</div>
<div class="bg-letter i">N</div>
<div class="bg-letter o">O</div>
<div class="bg-letter u">T</div>

<!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å -->
<header class="top-bar sticky top-0 z-40">
  <div class="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center">
    <a href="/" class="flex items-center gap-2 font-semibold text-[0.9rem] text-[#374151]">
      <img src="/assets/logo.png" alt="PolyTalky" class="w-7 h-7">
      PolyTalky
    </a>

    <div class="flex items-center gap-3 text-[0.78rem] text-gray-600">
      <div id="user-status"></div>

      <a href="/student/feedback.html"
         id="feedback-link"
         class="hidden relative flex items-center justify-center w-9 h-9 rounded-full border border-gray-300 bg-white">
        üì©
        <span id="feedback-dot"
              class="hidden absolute -top-1 -right-1 w-3 h-3 rounded-full bg-red-500 ring-2 ring-white"></span>
      </a>

      <a href="/student/"
         target="_blank"
         id="login-btn"
         class="hidden border border-gray-300 rounded-full px-3 py-1.5 text-[0.75rem] text-gray-600 bg-white">
        –í–æ–π—Ç–∏
      </a>

      <a href="/courses/english-intro/" class="back-to-course-btn">–ù–∞–∑–∞–¥ –∫ –∫—É—Ä—Å—É</a>
    </div>
  </div>
  
</header>

<main class="lesson-shell">
  <!-- HERO -->
  <section class="hero-card mb-8">
    <div class="hero-left">
      <div class="hero-badge">English ¬∑ Lesson 7</div>
      <h1 class="hero-title mt-3">
        –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≤ Present Simple
      </h1>

      <p class="hero-tagline mt-3">
        –£—á–∏–º—Å—è –≥–æ–≤–æ—Ä–∏—Ç—å "–Ω–µ—Ç" –ø–æ-–∞–Ω–≥–ª–∏–π—Å–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
      </p>
    </div>

    <div class="hero-right">
      <div class="hero-right-inner">
        <div class="hero-bg-circle"></div>

        <div class="hero-bubbles-cluster">
          <div class="hero-bubble hero-bubble--hello">
            I don't
          </div>
          <div class="hero-bubble hero-bubble--morning">
            She doesn't
          </div>
          <div class="hero-bubble hero-bubble--hi">
            NOT
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è —à–∞–≥–æ–≤ -->
  <div class="step-nav">
    <button class="step-dot step-dot--active" data-step="1">
      <div class="step-dot-circle">
        <img src="/assets/lessons/grammar.png" alt="–°—Ö–µ–º–∞">
      </div>
      <div class="step-dot-label">–°—Ö–µ–º–∞</div>
    </button>

    <button class="step-dot" data-step="2">
      <div class="step-dot-circle">
        <img src="/assets/lessons/order.png" alt="–ì–ª–∞–≥–æ–ª—ã">
      </div>
      <div class="step-dot-label">–ì–ª–∞–≥–æ–ª—ã</div>
    </button>

    <button class="step-dot" data-step="3">
      <div class="step-dot-circle">
        <img src="/assets/lessons/practise.png" alt="–ü—Ä–∞–∫—Ç–∏–∫–∞">
      </div>
      <div class="step-dot-label">–ü—Ä–∞–∫—Ç–∏–∫–∞</div>
    </button>

    <button class="step-dot" data-step="4">
      <div class="step-dot-circle">
        <img src="/assets/lessons/finish.png" alt="–§–∏–Ω–∞–ª">
      </div>
      <div class="step-dot-label">–§–∏–Ω–∏—à</div>
    </button>
  </div>

  <!-- ================ –®–ê–ì 1. –°–•–ï–ú–ê –û–¢–†–ò–¶–ê–¢–ï–õ–¨–ù–´–• –ü–†–ï–î–õ–û–ñ–ï–ù–ò–ô ================ -->
  <section id="step-1" class="step-panel step-panel--visible">
    <div class="step-panel-header">
      <span class="step-pill">–®–∞–≥ 1 ¬∑ –°—Ö–µ–º–∞</span>
      <button class="step-icon" type="button" data-open-qa>‚ùì</button>
    </div>

    <h2 class="text-xl md:text-2xl font-bold mb-3">
      –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≤ Present Simple
    </h2>

    <p class="step-body-text mb-3">
      –ü–æ–º–∏–º–æ —É—Ç–≤–µ—Ä–¥–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π, –∏–º–µ—é—Ç—Å—è —Ç–∞–∫–∂–µ <b>–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</b>:
    </p>

    <div class="example-box">
      <p class="text-lg mb-2">
        –ú–Ω–µ –Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —ç—Ç–æ—Ç —Ç–æ—Ä—Ç ‚Üí <span class="word-tip" data-ru="–º–Ω–µ –Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —ç—Ç–æ—Ç —Ç–æ—Ä—Ç">I do not like this cake</span>
      </p>
    </div>

    <p class="step-body-text mb-4 mt-4">
      –ü—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω—É–∂–Ω–æ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â—É—é —Å—Ö–µ–º—É:
    </p>

    <div class="sentence-scheme">
      <h3>üìê –°—Ö–µ–º–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</h3>
      
      <div class="scheme-parts">
        <div class="scheme-part subject">
          –ü–û–î–õ–ï–ñ–ê–©–ï–ï<br>
          <small>(–∫—Ç–æ/—á—Ç–æ)</small>
        </div>
        <span class="scheme-arrow">‚Üí</span>
        
        <div class="scheme-part auxiliary">
          –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ô<br>–ì–õ–ê–ì–û–õ<br>
          <small>(do/does)</small>
        </div>
        <span class="scheme-arrow">‚Üí</span>
        
        <div class="scheme-part not">
          NOT
        </div>
        <span class="scheme-arrow">‚Üí</span>
        
        <div class="scheme-part verb">
          –°–ö–ê–ó–£–ï–ú–û–ï<br>
          <small>(–≥–ª–∞–≥–æ–ª)</small>
        </div>
        <span class="scheme-arrow">‚Üí</span>
        
        <div class="scheme-part other">
          –í–°–Å –û–°–¢–ê–õ–¨–ù–û–ï
        </div>
      </div>
    </div>

    <div class="soft-block soft-block--blue mt-4">
      <p class="font-semibold mb-2">üí° –í–∞–∂–Ω–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å:</p>
      <ul class="list-disc ml-5 text-sm space-y-2">
        <li>–î–ª—è I, you, we, they –∏—Å–ø–æ–ª—å–∑—É–µ–º <b>do not</b> (—Å–æ–∫—Ä–∞—â–µ–Ω–Ω–æ <b>don't</b>)</li>
        <li>–î–ª—è he, she, it –∏—Å–ø–æ–ª—å–∑—É–µ–º <b>does not</b> (—Å–æ–∫—Ä–∞—â–µ–Ω–Ω–æ <b>doesn't</b>)</li>
        <li>–ì–ª–∞–≥–æ–ª –ø–æ—Å–ª–µ do/does –≤—Å–µ–≥–¥–∞ –≤ –Ω–∞—á–∞–ª—å–Ω–æ–π —Ñ–æ—Ä–º–µ (–±–µ–∑ -s/-es)</li>
      </ul>
    </div>

    <div class="example-box mt-4">
      <p class="mb-2"><strong>–ü—Ä–∏–º–µ—Ä—ã:</strong></p>
      <ul class="space-y-2 ml-4">
        <li>‚Ä¢ I <b>do not</b> like coffee ‚Üí –Ø –Ω–µ –ª—é–±–ª—é –∫–æ—Ñ–µ</li>
        <li>‚Ä¢ She <b>does not</b> work here ‚Üí –û–Ω–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–¥–µ—Å—å</li>
        <li>‚Ä¢ They <b>do not</b> speak English ‚Üí –û–Ω–∏ –Ω–µ –≥–æ–≤–æ—Ä—è—Ç –ø–æ-–∞–Ω–≥–ª–∏–π—Å–∫–∏</li>
        <li>‚Ä¢ He <b>doesn't</b> play football ‚Üí –û–Ω –Ω–µ –∏–≥—Ä–∞–µ—Ç –≤ —Ñ—É—Ç–±–æ–ª</li>
      </ul>
    </div>

    <button class="btn-main mt-6 next-step-btn" data-next="2">
      –î–∞–ª–µ–µ ‚Üí
    </button>
  </section>

  <!-- ================ –®–ê–ì 2. –°–ê–ú–û–°–¢–û–Ø–¢–ï–õ–¨–ù–´–ï –ì–õ–ê–ì–û–õ–´ ================ -->
  <section id="step-2" class="step-panel">
    <div class="step-panel-header">
      <span class="step-pill">–®–∞–≥ 2 ¬∑ –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–µ –≥–ª–∞–≥–æ–ª—ã</span>
      <button class="step-icon" type="button" data-open-qa>‚ùì</button>
    </div>

    <h2 class="text-xl md:text-2xl font-bold mb-3">
      –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –≥–ª–∞–≥–æ–ª DO
    </h2>

    <p class="step-body-text mb-3">
      <b>–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –≥–ª–∞–≥–æ–ª</b> –≤ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ ‚Äî —ç—Ç–æ –≥–ª–∞–≥–æ–ª <b>do</b> (–¥–ª—è he, she, it ‚Äî <b>does</b>).
    </p>

    <div class="soft-block soft-block--rose mt-4 mb-4">
      <p class="font-semibold mb-2">‚ö†Ô∏è –í–∞–∂–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ:</p>
      <p class="text-sm">
        –í –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —Å—É—â–µ—Å—Ç–≤—É—é—Ç <b>—Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–µ –≥–ª–∞–≥–æ–ª—ã</b> ‚Äî –∏—Ö —Å–æ–≤—Å–µ–º –Ω–µ–º–Ω–æ–≥–æ ‚Äî –∏ —Ç–∞–∫–∏–º –≥–ª–∞–≥–æ–ª–∞–º 
        –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –≥–ª–∞–≥–æ–ª —É–∂–µ <b>–Ω–µ –Ω—É–∂–µ–Ω</b>!
      </p>
    </div>

    <p class="step-body-text mb-4">
      –¢–æ –µ—Å—Ç—å –∫–æ–≥–¥–∞ —É –Ω–∞—Å –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ –æ–¥–∏–Ω –∏–∑ —ç—Ç–∏—Ö –≥–ª–∞–≥–æ–ª–æ–≤, —Ç–æ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –≥–ª–∞–≥–æ–ª –º—ã –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º, 
      –∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—É—é —á–∞—Å—Ç–∏—Ü—É <b>not</b> —Å—Ç–∞–≤–∏–º —Å—Ä–∞–∑—É –∫ —Å–∞–º–∏–º –≥–ª–∞–≥–æ–ª–∞–º. –í–æ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö –º—ã 
      –¥–µ–π—Å—Ç–≤—É–µ–º –ø–æ —Å—Ö–µ–º–µ –≤—ã—à–µ.
    </p>

    <div class="modal-verbs-box">
      <h4>üìã –°–ø–∏—Å–æ–∫ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã—Ö –≥–ª–∞–≥–æ–ª–æ–≤:</h4>
      
      <div class="modal-verbs-list">
        <div class="modal-verb-item">
          <strong>to be</strong> ‚Äî –±—ã—Ç—å<br>
          <small class="text-gray-600">I am <b>not</b> tired</small>
        </div>
        
        <div class="modal-verb-item">
          <strong>can (could)</strong> ‚Äî –º–æ—á—å (–º–æ–≥ –±—ã)<br>
          <small class="text-gray-600">I can<b>not</b> swim</small>
        </div>
        
        <div class="modal-verb-item">
          <strong>shall (should)</strong> ‚Äî —Å–ª–µ–¥—É–µ—Ç (—Å–ª–µ–¥–æ–≤–∞–ª–æ –±—ã)<br>
          <small class="text-gray-600">You should<b>n't</b> go</small>
        </div>
        
        <div class="modal-verb-item">
          <strong>must (might)</strong> ‚Äî –¥–æ–ª–∂–µ–Ω (–º–æ–≥ –±—ã)<br>
          <small class="text-gray-600">He must<b>n't</b> leave</small>
        </div>
      </div>
    </div>

    <div class="soft-block soft-block--green mt-4">
      <p class="font-semibold mb-2">üìå –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –æ WILL:</p>
      <p class="text-sm">
        *–•–æ—Ç—è –≥–ª–∞–≥–æ–ª <b>will</b> —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–π, –æ–Ω –æ–±—Ä–∞–∑—É–µ—Ç <b>Future Simple</b> ‚Äî –±—É–¥—É—â–µ–µ –≤—Ä–µ–º—è, 
        –∏ –≤ Present Simple –æ–Ω –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.
      </p>
    </div>

    <div class="example-box mt-4">
      <p class="mb-2"><strong>–°—Ä–∞–≤–Ω–∏—Ç–µ:</strong></p>
      <div class="space-y-3">
        <div class="p-3 bg-white rounded-lg">
          <p class="font-semibold text-gray-800">–° –æ–±—ã—á–Ω—ã–º –≥–ª–∞–≥–æ–ª–æ–º:</p>
          <p class="text-sm text-gray-600 ml-4">
            I <b>do not</b> like coffee. (–Ω—É–∂–µ–Ω do)
          </p>
        </div>
        
        <div class="p-3 bg-white rounded-lg">
          <p class="font-semibold text-gray-800">–° —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–º –≥–ª–∞–≥–æ–ª–æ–º:</p>
          <p class="text-sm text-gray-600 ml-4">
            I <b>am not</b> tired. (do –Ω–µ –Ω—É–∂–µ–Ω)
          </p>
        </div>
      </div>
    </div>

    <button class="btn-main mt-6 next-step-btn" data-next="3">
      –ü–µ—Ä–µ–π—Ç–∏ –∫ –ø—Ä–∞–∫—Ç–∏–∫–µ ‚Üí
    </button>
  </section>

  <!-- ================ –®–ê–ì 3. –£–ü–†–ê–ñ–ù–ï–ù–ò–Ø ================ -->
  <section id="step-3" class="step-panel">
    <div class="step-panel-header">
      <span class="step-pill">–®–∞–≥ 3 ¬∑ –ü—Ä–∞–∫—Ç–∏–∫–∞</span>
      <button class="step-icon" type="button" data-open-qa>‚ùì</button>
    </div>

    <h2 class="text-xl md:text-2xl font-bold mb-3">
      –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ ‚Ññ1: –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
    </h2>

    <p class="step-body-text mb-4">
      –í—Å–ø–æ–º–Ω–∏—Ç–µ —Å—Ö–µ–º—É –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç:
    </p>

    <!-- –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Å—Ö–µ–º—ã -->
    <div class="soft-block soft-block--blue mb-4">
      <p class="font-semibold mb-2 text-center">
        –ü–û–î–õ–ï–ñ–ê–©–ï–ï ‚Üí do/does ‚Üí NOT ‚Üí –ì–õ–ê–ì–û–õ ‚Üí –í–°–Å –û–°–¢–ê–õ–¨–ù–û–ï
      </p>
    </div>

    <div id="choiceExercises">
      <!-- Will be filled by JavaScript -->
    </div>

    <div id="choice-feedback" class="feedback-message"></div>

    <!-- –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 2 -->
    <div id="writing-exercise-section" class="hidden">
      <h2 class="text-xl md:text-2xl font-bold mb-3 mt-8">
        –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ ‚Ññ2: –°–æ—Å—Ç–∞–≤—å—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
      </h2>

      <p class="step-body-text mb-4">
        –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –≤ Present Simple, 
        –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ —Å—Ö–µ–º—É –≤—ã—à–µ.
      </p>

      <div class="writing-exercise">
        <div class="writing-prompt">
          <strong>–ó–∞–¥–∞–Ω–∏–µ:</strong> –ù–∞–ø–∏—à–∏—Ç–µ 3-5 –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –≤ Present Simple.<br>
          <br>
          <strong>–ü—Ä–∏–º–µ—Ä—ã —Ç–µ–º:</strong>
          <ul class="list-disc ml-5 mt-2 text-sm">
            <li>–ß—Ç–æ –≤—ã –Ω–µ –ª—é–±–∏—Ç–µ –¥–µ–ª–∞—Ç—å</li>
            <li>–ß–µ–≥–æ –Ω–µ —É–º–µ–µ—Ç –≤–∞—à –¥—Ä—É–≥</li>
            <li>–ß—Ç–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –≤–∞—à–µ–π –∂–∏–∑–Ω–∏</li>
          </ul>
          <br>
          <span id="pro-status-message"></span>
        </div>

        <textarea 
          id="sentences-textarea" 
          class="sentence-textarea"
          placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –∑–¥–µ—Å—å —Å–≤–æ–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è...&#10;&#10;–ù–∞–ø—Ä–∏–º–µ—Ä:&#10;I do not like getting up early.&#10;My brother does not play the guitar.&#10;We are not lazy students."
        ></textarea>

        <button id="submit-sentences-btn" class="submit-btn">
          –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
        </button>

        <div id="writing-feedback" class="feedback-message"></div>
      </div>
    </div>

    <button id="next-btn-step3" class="btn-main mt-6 next-step-btn hidden" data-next="4">
      –ó–∞–≤–µ—Ä—à–∏—Ç—å —É—Ä–æ–∫ ‚Üí
    </button>
  </section>

  <!-- ================ –®–ê–ì 4. –§–ò–ù–ê–õ ================ -->
  <section id="step-4" class="step-panel">
    <div class="step-panel-header">
      <span class="step-pill">–®–∞–≥ 4 ¬∑ –§–ò–ù–ê–õ</span>
      <button class="step-icon" type="button" data-open-qa>‚ùì</button>
    </div>

    <h2 class="text-xl md:text-2xl font-bold mb-3">
      –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –£—Ä–æ–∫ 7 –∑–∞–≤–µ—Ä—à—ë–Ω üéâ
    </h2>

    <p class="step-body-text mb-3">
      –í—ã –æ—Å–≤–æ–∏–ª–∏ <b>–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≤ Present Simple</b>!
    </p>

    <div class="soft-block soft-block--blue mb-4">
      <p class="font-semibold mb-2">–ß—Ç–æ –º—ã —É–∑–Ω–∞–ª–∏:</p>
      <ul class="list-disc ml-5 text-sm space-y-1">
        <li>‚úì –°—Ö–µ–º–∞: –ø–æ–¥–ª–µ–∂–∞—â–µ–µ ‚Üí do/does ‚Üí NOT ‚Üí –≥–ª–∞–≥–æ–ª ‚Üí –æ—Å—Ç–∞–ª—å–Ω–æ–µ</li>
        <li>‚úì –î–ª—è I/you/we/they –∏—Å–ø–æ–ª—å–∑—É–µ–º <b>do not (don't)</b></li>
        <li>‚úì –î–ª—è he/she/it –∏—Å–ø–æ–ª—å–∑—É–µ–º <b>does not (doesn't)</b></li>
        <li>‚úì –ü–æ—Å–ª–µ do/does –≥–ª–∞–≥–æ–ª –≤—Å–µ–≥–¥–∞ –≤ –Ω–∞—á–∞–ª—å–Ω–æ–π —Ñ–æ—Ä–º–µ</li>
        <li>‚úì –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–µ –≥–ª–∞–≥–æ–ª—ã (be, can, must –∏ –¥—Ä.) –Ω–µ —Ç—Ä–µ–±—É—é—Ç do/does</li>
      </ul>
    </div>

    <p class="step-body-text mb-4">
      –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ —É–≤–µ—Ä–µ–Ω–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å –∫–∞–∫ —É—Ç–≤–µ—Ä–¥–∏—Ç–µ–ª—å–Ω—ã–µ, —Ç–∞–∫ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è 
      –≤ –Ω–∞—Å—Ç–æ—è—â–µ–º –≤—Ä–µ–º–µ–Ω–∏!
    </p>

    <div class="flex justify-center my-4">
      <img src="/assets/gifs/english-lesson7-finish.gif" alt="Finish gif"
           class="w-64 h-auto rounded-2xl"
           onerror="this.style.display='none'">
    </div>

    <div class="mt-5 flex flex-wrap gap-3">
      <a href="/courses/english-intro/lesson-08.html" class="btn-main">
        –ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —É—Ä–æ–∫—É ‚Üí
      </a>

      <a href="/courses/english-intro/" class="btn-ghost">
        –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∫—É—Ä—Å—É
      </a>
    </div>
  </section>

  <!-- –ú–û–î–ê–õ–ö–ê Q&A -->
  <div id="qa-modal"
       class="fixed inset-0 bg-black/40 backdrop-blur-sm hidden items-center justify-center z-50 p-4">

    <div class="bg-white max-w-lg w-full rounded-2xl shadow-xl relative overflow-hidden">
      <div class="absolute -top-8 -left-8 w-36 h-36 rounded-full bg-[#FFE8B3] blur-xl opacity-60"></div>
      <div class="absolute -bottom-10 -right-10 w-40 h-40 rounded-full bg-[#FFD4A8] blur-xl opacity-60"></div>

      <div class="relative p-6 space-y-4">
        <div class="flex justify-between items-start gap-4">
          <div>
            <h2 class="text-lg font-semibold text-gray-800">
              –í–æ–ø—Ä–æ—Å—ã –ø–æ —É—Ä–æ–∫—É
            </h2>
            <p class="text-sm text-gray-600 mt-1">
              –ù–∞–ø–∏—à–∏—Ç–µ —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å ‚Äî –º—ã –æ—Ç–≤–µ—Ç–∏–º –∏ –æ—Ç–≤–µ—Ç —É–≤–∏–¥—è—Ç –¥—Ä—É–≥–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏.
            </p>
          </div>

          <button id="qa-close"
                  class="text-gray-500 text-xl leading-none">&times;</button>
        </div>

        <div class="bg-amber-50 border border-amber-200 rounded-xl p-3 text-xs text-amber-800">
          –•–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç—å –æ—Ç–≤–µ—Ç—ã –µ—â—ë –±—ã—Å—Ç—Ä–µ–µ –∏ –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∫—É—Ä–∞—Ç–æ—Ä—É –ª–∏—á–Ω–æ?  
          <a href="/courses/pro.html" target="_blank" class="underline text-amber-700 font-semibold">–¢–∞—Ä–∏—Ñ PRO</a> –¥–∞—ë—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –∏ –±–æ–ª—å—à–µ –≤–Ω–∏–º–∞–Ω–∏—è –∫ –≤–∞—à–∏–º –≤–æ–ø—Ä–æ—Å–∞–º üíõ
        </div>

        <div class="max-h-64 overflow-y-auto border border-gray-100 rounded-xl p-3 bg-gray-50/70"
             id="qa-list">
          <p class="text-xs text-gray-500">
            –ü–æ–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ –Ω–µ—Ç ‚Äî –≤—ã –º–æ–∂–µ—Ç–µ –±—ã—Ç—å –ø–µ—Ä–≤—ã–º, –∫—Ç–æ –∑–∞–¥–∞—Å—Ç –≤–æ–ø—Ä–æ—Å üôÇ
          </p>
        </div>

        <form id="qa-form" class="space-y-2">
          <label class="block text-xs text-gray-600">
            –í–∞—à –≤–æ–ø—Ä–æ—Å:
          </label>
          <textarea id="qa-text"
                    class="w-full border border-gray-200 rounded-xl px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-amber-300"
                    rows="3"
                    placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: ¬´–ö–∞–∫ —Å–æ–∫—Ä–∞—â–∞—Ç—å do not –∏ does not?¬ª"></textarea>

          <p class="text-[0.7rem] text-gray-400">
            –ß—Ç–æ–±—ã –∑–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å, –Ω—É–∂–Ω–æ –≤–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç.  
            –ï—Å–ª–∏ –≤—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
            <a href="/student/" class="underline">–≤—Ö–æ–¥–∞ / —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</a>.
          </p>

          <div class="flex justify-end">
            <button type="submit"
                    id="qa-submit"
                    class="btn-main text-sm px-4 py-1.5">
              –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤–æ–ø—Ä–æ—Å ‚Üí
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

</main>

<!-- ============================= -->
<!-- –ö–û–ù–§–ò–ì –£–†–û–ö–ê (–í–ê–ñ–ù–û!) -->
<!-- ============================= -->
<script type="module">
  window.lessonConfig = {
    lessonId:        "english-intro-lesson-7",
    lessonSlug:      "lesson-07-negative-present-simple",
    courseId:        "english-intro",
    lessonQaDocId:   "english-intro-lesson-7",
    submissionsRoot: "lessonSubmissions",
    totalSteps:      4,
    audioNextStep:   null,
    vocabCategory:   "vocabulary-lesson7"
  };
</script>

<script type="module">
// =========================================================
// üî∏ –ò–ú–ü–û–†–¢–´ –î–õ–Ø FIREBASE
// =========================================================
import {
  doc,
  setDoc,
  serverTimestamp,
  getDoc
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const db = window.firebaseDb;
const auth = window.firebaseAuth;

let currentUser = null;
let isProUser = false;

// –°–ª–µ–¥–∏–º –∑–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
auth.onAuthStateChanged(async (user) => {
  currentUser = user;
  
  if (user) {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å PRO
    await checkProStatus(user);
    updateProMessage();
  }
});

// –ü—Ä–æ–≤–µ—Ä–∫–∞ PRO —Å—Ç–∞—Ç—É—Å–∞
async function checkProStatus(user) {
  try {
    const email = user.email || null;
    const uid = user.uid || null;
    
    if (!email && !uid) {
      isProUser = false;
      return;
    }

    const emailRef = email ? doc(db, "users", email) : null;
    const uidRef = uid ? doc(db, "users", uid) : null;

    const [emailSnap, uidSnap] = await Promise.all([
      emailRef ? getDoc(emailRef) : Promise.resolve(null),
      uidRef ? getDoc(uidRef) : Promise.resolve(null),
    ]);

    const emailData = emailSnap && emailSnap.exists() ? emailSnap.data() : {};
    const uidData = uidSnap && uidSnap.exists() ? uidSnap.data() : {};
    const merged = { ...uidData, ...emailData };

    const proGlobal = merged.proGlobal === true;
    let proValidUntil = merged.proValidUntil || merged.proUntil || null;
    
    if (proValidUntil && typeof proValidUntil.toDate === "function") {
      proValidUntil = proValidUntil.toDate();
    }

    const legacyPro = merged.proActive || merged.isPro || merged.hasPro || 
                      (merged.pro && merged.pro.active);

    let active = !!(proGlobal || legacyPro);

    if (proValidUntil instanceof Date) {
      const now = new Date();
      if (proValidUntil <= now) {
        active = false;
      }
    }

    isProUser = active;
  } catch (e) {
    console.error("–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ PRO —Å—Ç–∞—Ç—É—Å–∞:", e);
    isProUser = false;
  }
}

function updateProMessage() {
  const proMsg = document.getElementById('pro-status-message');
  if (!proMsg) return;

  if (isProUser) {
    proMsg.innerHTML = `
      <span class="pro-badge">‚ú® PRO</span> 
      <span class="text-sm">–í–∞—à–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –∫—É—Ä–∞—Ç–æ—Ä—É –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É!</span>
    `;
  } else {
    proMsg.innerHTML = `
      <span class="text-sm text-gray-600">
        –í–∞—à–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã. 
        <a href="/courses/pro.html" class="underline text-amber-700 font-semibold">–¢–∞—Ä–∏—Ñ PRO</a> 
        –¥–∞—ë—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –æ—Ç –∫—É—Ä–∞—Ç–æ—Ä–∞!
      </span>
    `;
  }
}

// =========================================================
// üî∏ –£–ü–†–ê–ñ–ù–ï–ù–ò–ï 1: –í–´–ë–û–† –ü–†–ê–í–ò–õ–¨–ù–û–ì–û –í–ê–†–ò–ê–ù–¢–ê
// =========================================================

const choiceQuestions = [
  {
    question: "I ___ like coffee.",
    options: ["not", "do not", "does not", "am not"],
    correct: "do not",
    explanation: "–î–ª—è 'I' –∏—Å–ø–æ–ª—å–∑—É–µ–º 'do not'. 'Am not' –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å –≥–ª–∞–≥–æ–ª–æ–º 'to be'."
  },
  {
    question: "She ___ work here.",
    options: ["not", "do not", "does not", "is not"],
    correct: "does not",
    explanation: "–î–ª—è 'she' –∏—Å–ø–æ–ª—å–∑—É–µ–º 'does not'."
  },
  {
    question: "They ___ speak English.",
    options: ["not", "do not", "does not", "are not"],
    correct: "do not",
    explanation: "–î–ª—è 'they' –∏—Å–ø–æ–ª—å–∑—É–µ–º 'do not'."
  },
  {
    question: "He ___ play football.",
    options: ["not", "do not", "does not", "is not"],
    correct: "does not",
    explanation: "–î–ª—è 'he' –∏—Å–ø–æ–ª—å–∑—É–µ–º 'does not'."
  },
  {
    question: "I ___ tired. (–≥–ª–∞–≥–æ–ª to be)",
    options: ["not", "do not", "does not", "am not"],
    correct: "am not",
    explanation: "'To be' ‚Äî —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–π –≥–ª–∞–≥–æ–ª, –ø–æ—ç—Ç–æ–º—É 'am not' (–±–µ–∑ 'do')."
  },
  {
    question: "She ___ swim. (–≥–ª–∞–≥–æ–ª can)",
    options: ["not can", "can not", "does not can", "do not can"],
    correct: "can not",
    explanation: "'Can' ‚Äî —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–π –≥–ª–∞–≥–æ–ª, –ø–æ—ç—Ç–æ–º—É 'can not' –∏–ª–∏ 'cannot' (–±–µ–∑ 'do')."
  }
];

let selectedAnswers = {};

function renderChoiceExercises() {
  const container = document.getElementById('choiceExercises');
  container.innerHTML = '';

  choiceQuestions.forEach((q, index) => {
    const div = document.createElement('div');
    div.className = 'exercise-choice';
    div.id = `choice-${index}`;

    div.innerHTML = `
      <div class="exercise-question">${index + 1}. ${q.question}</div>
      <div class="choice-options" id="options-${index}">
        ${q.options.map((opt, optIdx) => `
          <button 
            class="choice-btn" 
            data-question="${index}"
            data-answer="${opt}"
            onclick="selectAnswer(${index}, '${opt}')"
          >
            ${opt}
          </button>
        `).join('')}
      </div>
      <div id="explanation-${index}" class="hidden mt-3 p-3 bg-white rounded-lg text-sm"></div>
    `;

    container.appendChild(div);
  });
}

window.selectAnswer = function(questionIndex, answer) {
  selectedAnswers[questionIndex] = answer;

  // Update UI
  const buttons = document.querySelectorAll(`[data-question="${questionIndex}"]`);
  buttons.forEach(btn => {
    btn.classList.remove('selected');
    if (btn.dataset.answer === answer) {
      btn.classList.add('selected');
    }
  });
};

function checkChoiceAnswers() {
  let allCorrect = true;
  let correctCount = 0;

  choiceQuestions.forEach((q, index) => {
    const userAnswer = selectedAnswers[index];
    const isCorrect = userAnswer === q.correct;
    const exerciseDiv = document.getElementById(`choice-${index}`);
    const explanationDiv = document.getElementById(`explanation-${index}`);
    const buttons = document.querySelectorAll(`[data-question="${index}"]`);

    if (isCorrect) {
      correctCount++;
      exerciseDiv.classList.add('correct');
      exerciseDiv.classList.remove('incorrect');
      
      buttons.forEach(btn => {
        btn.disabled = true;
        if (btn.dataset.answer === q.correct) {
          btn.classList.add('correct');
        }
      });

      explanationDiv.innerHTML = `‚úì –ü—Ä–∞–≤–∏–ª—å–Ω–æ! ${q.explanation}`;
      explanationDiv.className = 'mt-3 p-3 bg-green-50 rounded-lg text-sm text-green-800';
    } else {
      allCorrect = false;
      exerciseDiv.classList.add('incorrect');
      exerciseDiv.classList.remove('correct');

      buttons.forEach(btn => {
        btn.disabled = true;
        if (btn.dataset.answer === userAnswer) {
          btn.classList.add('incorrect');
        }
        if (btn.dataset.answer === q.correct) {
          btn.classList.add('correct');
        }
      });

      explanationDiv.innerHTML = `‚úó –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: <strong>${q.correct}</strong>. ${q.explanation}`;
      explanationDiv.className = 'mt-3 p-3 bg-red-50 rounded-lg text-sm text-red-800';
    }
  });

  // Show feedback
  const feedbackBox = document.getElementById('choice-feedback');
  feedbackBox.classList.remove('success', 'info');
  feedbackBox.classList.add('show');

  if (allCorrect) {
    feedbackBox.classList.add('success');
    feedbackBox.innerHTML = `
      <strong>üéâ –û—Ç–ª–∏—á–Ω–æ!</strong> –í—Å–µ –æ—Ç–≤–µ—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ! –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫–æ –≤—Ç–æ—Ä–æ–º—É —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—é.
    `;
    
    // Show writing exercise
    setTimeout(() => {
      document.getElementById('writing-exercise-section').classList.remove('hidden');
      document.getElementById('writing-exercise-section').scrollIntoView({ behavior: 'smooth' });
    }, 1500);
  } else {
    feedbackBox.classList.add('info');
    feedbackBox.innerHTML = `
      <strong>–ü–æ—á—Ç–∏ –ø–æ–ª—É—á–∏–ª–æ—Å—å!</strong> –ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: ${correctCount} –∏–∑ ${choiceQuestions.length}. 
      –ò–∑—É—á–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫–æ –≤—Ç–æ—Ä–æ–º—É —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—é.
    `;
    
    // Show writing exercise anyway
    setTimeout(() => {
      document.getElementById('writing-exercise-section').classList.remove('hidden');
      document.getElementById('writing-exercise-section').scrollIntoView({ behavior: 'smooth' });
    }, 2000);
  }
}

// Initialize choice exercise
renderChoiceExercises();

// Add event listener to check when all questions are answered
setInterval(() => {
  const answeredCount = Object.keys(selectedAnswers).length;
  if (answeredCount === choiceQuestions.length) {
    // Auto-check after all answered
    const feedbackBox = document.getElementById('choice-feedback');
    if (!feedbackBox.classList.contains('show')) {
      checkChoiceAnswers();
    }
  }
}, 500);

// =========================================================
// üî∏ –£–ü–†–ê–ñ–ù–ï–ù–ò–ï 2: –ù–ê–ü–ò–°–ê–ù–ò–ï –ü–†–ï–î–õ–û–ñ–ï–ù–ò–ô
// =========================================================

const submitBtn = document.getElementById('submit-sentences-btn');
const textarea = document.getElementById('sentences-textarea');
const writingFeedback = document.getElementById('writing-feedback');
const nextBtn = document.getElementById('next-btn-step3');

async function saveUserSentences(sentences) {
  if (!currentUser) {
    console.log("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ");
    localStorage.setItem('lesson7_sentences', sentences);
    return { saved: true, isPro: false };
  }

  const userKey = currentUser.email || currentUser.uid;
  const answerRef = doc(
    db,
    "lessonSubmissions",
    "english-intro-lesson-7",
    "answers",
    userKey
  );

  try {
    await setDoc(
      answerRef,
      {
        sentences: sentences,
        userEmail: currentUser.email || null,
        userUid: currentUser.uid,
        isPro: isProUser,
        courseId: "english-intro",
        lessonSlug: "lesson-07-negative-present-simple",
        submittedAt: serverTimestamp(),
        needsReview: isProUser,
        reviewed: false
      },
      { merge: true }
    );

    return { saved: true, isPro: isProUser };
  } catch (e) {
    console.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:", e);
    return { saved: false, isPro: isProUser };
  }
}

submitBtn.addEventListener('click', async () => {
  const sentences = textarea.value.trim();

  if (!sentences) {
    writingFeedback.classList.remove('success', 'info');
    writingFeedback.classList.add('show', 'info');
    writingFeedback.innerHTML = `
      <strong>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ.</strong>
    `;
    return;
  }

  submitBtn.disabled = true;
  submitBtn.textContent = "–û—Ç–ø—Ä–∞–≤–ª—è–µ–º...";

  const result = await saveUserSentences(sentences);

  submitBtn.disabled = false;
  submitBtn.textContent = "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è";

  writingFeedback.classList.remove('success', 'info');
  writingFeedback.classList.add('show', 'success');

  if (result.saved) {
    if (result.isPro) {
      writingFeedback.innerHTML = `
        <strong>‚ú® –û—Ç–ª–∏—á–Ω–æ!</strong> –í–∞—à–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –∫—É—Ä–∞—Ç–æ—Ä—É –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É. 
        –í—ã –ø–æ–ª—É—á–∏—Ç–µ –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ!
      `;
    } else {
      writingFeedback.innerHTML = `
        <strong>‚úì –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!</strong> –í–∞—à–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã. 
        –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å—Å—è.
      `;
    }
    
    // Show next button
    nextBtn.classList.remove('hidden');
  } else {
    writingFeedback.classList.remove('success');
    writingFeedback.classList.add('info');
    writingFeedback.innerHTML = `
      <strong>–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏.</strong> –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.
    `;
  }
});
</script>

<!-- ============================= -->
<!-- –û–ë–©–ò–ô –°–ö–†–ò–ü–¢ –ö–£–†–°–ê (–í–ê–ñ–ù–û!) -->
<!-- ============================= -->
<script type="module" src="/js/courses/english-intro.js"></script>

</body>
</html>
‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã
