<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PolyTalky ‚Äî English Intro</title>
  <meta name="description" content="–ê–Ω–≥–ª–∏–π—Å–∫–∏–π –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤: –∫–æ—Ä–æ—Ç–∫–∏–µ —É—Ä–æ–∫–∏ –ø–æ 10‚Äì15 –º–∏–Ω—É—Ç, –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è, —Å–ª–æ–≤–∞—Ä–∏–∫, —Ç—Ä–µ–Ω–∞–∂—ë—Ä—ã –∏ –ø—Ä–∞–∫—Ç–∏–∫–∞.">
  <base href="/">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" type="image/jpg" href="/assets/favicon.jpg">

  <style>
    :root{
      --brand-yellow:#FFDE59;
      --brand-yellow-deep:#FFBA08;
      --brand-orange:#E85D04;
      --ink:#0F172A;
      --ink-2:#334155;
      --bg:#FFF8D6;
    }
    body{
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      background:radial-gradient(circle at top,#fffef2 0,#FFF8D6 40%,#FFEFC0 100%);
      color:var(--ink);
    }
    .shadow-soft{box-shadow:0 14px 40px rgba(0,0,0,.12)}
    .pill{
      border-radius:999px;
      padding:.45rem .9rem;
      font-size:.75rem;
      border:1px solid rgba(0,0,0,.06);
      background:#ffffffdd;
      backdrop-filter:blur(8px);
    }
    .mode-btn-active{
      background:#111827 !important;
      color:#f9fafb !important;
      box-shadow:0 10px 30px rgba(0,0,0,.18);
      border-color:rgba(0,0,0,.4);
    }
    .pt-progress-outer{
      width:100%;
      border-radius:999px;
      background:#f3f4f6;
      overflow:hidden;
      height:10px;
    }
    .pt-progress-inner{
      height:100%;
      width:0%;
      border-radius:999px;
      background:linear-gradient(90deg,var(--brand-orange),var(--brand-yellow));
      transition:width .3s ease;
    }

    /* –ö—Ä—É–≥–ª—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ hero */
    .circle-progress{
      position:relative;
      width:160px;
      height:160px;
      border-radius:999px;
      background:conic-gradient(from 210deg, var(--brand-orange), var(--brand-yellow), #fde68a, #e5e7eb);
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow:0 18px 50px rgba(0,0,0,.18);
    }
    .circle-inner{
      width:120px;
      height:120px;
      border-radius:999px;
      background:#fffef7;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      text-align:center;
    }

    .glass-card{
      background:#fffef7ee;
      backdrop-filter:blur(10px);
      border-radius:1.75rem;
      border:1px solid rgba(15,23,42,.08);
    }

    @media (min-width: 1024px){
      .hero-grid{
        display:grid;
        grid-template-columns:minmax(0,1.6fr) minmax(0,1fr);
        gap:3rem;
        align-items:center;
      }
    }

    @media (max-width: 640px){
      .hero-grid{
        display:flex;
        flex-direction:column;
        gap:1.75rem;
      }
    }
  </style>
</head>
<body>

<!-- HEADER (–∞–¥–∞–ø—Ç–∞—Ü–∏—è –≥–ª–∞–≤–Ω–æ–π) -->
<header class="sticky top-0 z-50 bg-[#fffef7]/80 backdrop-blur border-b border-black/10">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex items-center justify-between gap-4">
    <a href="./" class="flex items-center gap-3 font-semibold text-lg">
      <img src="/assets/logo.png" alt="PolyTalky" class="h-8 w-8 rounded-xl">
      <span>PolyTalky</span>
    </a>

    <nav class="hidden md:flex items-center gap-6 text-sm text-[var(--ink-2)]">
      <a href="/courses/" class="hover:opacity-80">–ö—É—Ä—Å—ã</a>
      <a href="/shop/" class="hover:opacity-80">–ú–∞–≥–∞–∑–∏–Ω</a>
      <a href="/student/" class="hover:opacity-80">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
      <a id="header-login-link"
        href="/student/"
        class="inline-flex items-center gap-2 bg-[var(--brand-yellow)] hover:bg-[var(--brand-yellow-deep)] px-4 py-2 rounded-xl text-sm font-semibold text-[#1a1a1a] shadow-soft"
      > –í–æ–π—Ç–∏ </a> <span id="header-email" class="hidden text-xs px-3 py-1.5 rounded-xl bg-white border border-black/10 shadow-soft max-w-[220px] truncate">
        </span>
    </nav>

    <button id="burger" class="md:hidden inline-flex items-center justify-center h-10 w-10 rounded-xl bg-white border border-black/10 shadow-soft" aria-label="–ú–µ–Ω—é">
      ‚ò∞
    </button>
  </div>

  <div id="mnav" class="md:hidden hidden border-t border-black/10 bg-[#fffef7]">
    <div class="max-w-7xl mx-auto px-4 py-3 grid gap-2 text-[var(--ink-2)]">
      <a class="px-3 py-3 rounded-xl bg-white border border-black/10 shadow-soft" href="/courses/">–ö—É—Ä—Å—ã</a>
      <a class="px-3 py-3 rounded-xl bg-white border border-black/10 shadow-soft" href="/shop/">–ú–∞–≥–∞–∑–∏–Ω</a>
      <a class="px-3 py-3 rounded-xl bg-white border border-black/10 shadow-soft" href="/student/">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
     <a
  id="header-login-link-mobile"
  class="px-3 py-3 rounded-xl bg-[var(--brand-yellow)] text-[#1a1a1a] font-semibold shadow-soft"
  href="/student/"
>
  –í–æ–π—Ç–∏
</a>

<div
  id="header-email-mobile"
  class="hidden px-3 py-3 rounded-xl bg-white border border-black/10 shadow-soft text-xs text-[var(--ink-2)] truncate"
></div>
  </div> </div>
</header>

<main>
  <!-- HERO —Å –≤–∞—É-—ç—Ñ—Ñ–µ–∫—Ç–æ–º -->
  <section class="pt-10 pb-8 sm:pt-12 sm:pb-10">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 hero-grid">
      <!-- –¢–µ–∫—Å—Ç -->
      <div class="space-y-4">
        <span class="pill inline-flex items-center gap-2">
          <span class="text-xs">English Intro ¬∑ A1</span>
          <span class="text-[10px] px-2 py-0.5 rounded-full bg-[#ecfccb] text-[#3f6212] border border-[#bbf7d0]">
            –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø
          </span>
        </span>
        <h1 class="text-3xl sm:text-4xl lg:text-[2.6rem] font-extrabold leading-tight tracking-tight">
          –ö—É—Ä—Å –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ, –≥–¥–µ –∫–∞–∂–¥—ã–π —É—Ä–æ–∫ ‚Äî –º–∞–ª–µ–Ω—å–∫–∏–π –ø–æ–±–µ–¥–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å üéÆ
        </h1>
        <p class="text-sm sm:text-base text-[var(--ink-2)] max-w-xl">
          –í–º–µ—Å—Ç–æ —Ç—è–∂—ë–ª—ã—Ö –∑–∞–Ω—è—Ç–∏–π –Ω–∞ 45 –º–∏–Ω—É—Ç ‚Äî –∫–æ—Ä–æ—Ç–∫–∏–µ —É—Ä–æ–∫–∏ –ø–æ 10‚Äì15 –º–∏–Ω—É—Ç, XP, —Å–µ—Ä–∏—è –¥–Ω–µ–π –∏ –∂–∏–≤—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è.
          –£—Ä–æ–∫–∏, —Å–ª–æ–≤–∞—Ä–∏–∫, —Ç—Ä–µ–Ω–∞–∂—ë—Ä—ã –∏ –ø—Ä–∞–∫—Ç–∏–∫–∞ ‚Äî –≤ –æ–¥–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ.
        </p>

     <div class="flex flex-wrap gap-3 pt-1">
  <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "–ù–∞—á–∞—Ç—å –∫—É—Ä—Å" -->
  <a id="btn-start"
     href="/courses/english-intro/lesson-01-hello.html"
     class="inline-flex items-center gap-2 px-5 py-3 rounded-2xl bg-[var(--brand-yellow)] hover:bg-[var(--brand-yellow-deep)] text-sm font-semibold text-[#1a1a1a] shadow-soft">
    ‚ñ∂ –ù–∞—á–∞—Ç—å –∫—É—Ä—Å
  </a>

  <!-- –ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å" —Å–∫—Ä—ã—Ç–∞, –ø–æ–∫–∞ –Ω–µ –∑–Ω–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å -->
  <button id="btn-continue"
          class="hidden inline-flex items-center gap-2 px-5 py-3 rounded-2xl border border-black/10 bg-white/90 hover:bg-[#fff3c6] text-sm text-[var(--ink-2)] shadow-soft">
    ‚è± –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å –º–µ—Å—Ç–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
  </button>
</div>
        <div class="flex flex-wrap gap-2 text-[11px] text-[var(--ink-2)] pt-2">
          <span class="pill">10‚Äì15 –º–∏–Ω—É—Ç –Ω–∞ —É—Ä–æ–∫</span>
          <span class="pill">–ú—É–ª—å—Ç–∏–º–µ–¥–∏–∞: —Ç–µ–∫—Å—Ç, –≤–∏–¥–µ–æ, –∫–∞—Ä—Ç–∏–Ω–∫–∏, –∑–∞–¥–∞–Ω–∏—è</span>
          <span class="pill">–°–ª–æ–≤–∞—Ä–∏–∫ + —Ç—Ä–µ–Ω–∞–∂—ë—Ä –≤–Ω—É—Ç—Ä–∏ –∫—É—Ä—Å–∞</span>
        </div>
      </div>

      <!-- –ö—Ä—É–≥–ª—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –º–∏–Ω–∏-—Å—Ç–∞—Ç—ã -->
      <aside class="glass-card shadow-soft p-6 flex flex-col items-center gap-4">
        <div class="circle-progress">
          <div class="circle-inner">
            <p class="text-[10px] uppercase tracking-wide text-[var(--ink-2)] mb-1">–í–∞—à —É—Ä–æ–≤–µ–Ω—å</p>
            <p class="text-3xl font-extrabold" id="stat-level">1</p>
            <p class="text-[11px] text-[var(--ink-2)]">
              <span id="stat-xp">0</span> XP
            </p>
          </div>
        </div>

        <div class="w-full space-y-2">
          <div class="flex items-center justify-between text-[11px] text-[var(--ink-2)]">
            <span>–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —É—Ä–æ–∫–∞–º</span>
            <span id="progress-text">0 / 0</span>
          </div>
          <div class="pt-progress-outer">
            <div id="progress-bar" class="pt-progress-inner"></div>
          </div>
        </div>

        <div class="w-full">
          <p class="text-[11px] text-[var(--ink-2)] mb-1">–°–µ—Ä–∏—è –¥–Ω–µ–π</p>
          <p class="text-sm font-semibold" id="stat-streak">0 –¥–Ω–µ–π</p>
        </div>

        <div class="w-full">
          <p class="text-[11px] text-[var(--ink-2)] mb-1">–ë–µ–π–¥–∂–∏</p>
          <div id="badge-row" class="flex flex-wrap gap-3 text-[10px]"></div>
        </div>
      </aside>
    </div>
  </section>


           
      <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–µ–∂–∏–º–æ–≤ –∫—É—Ä—Å–∞ -->
  <section class="pb-14" id="course-modes">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="glass-card shadow-soft px-4 sm:px-6 lg:px-8 py-5 sm:py-6">
        <!-- –ö—Ä—É–ø–Ω—ã–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å -->
        <div class="flex flex-wrap gap-2 justify-center mb-6">
          <button data-tab="lessons" class="mode-btn mode-btn-active inline-flex items-center gap-2 px-4 py-2 text-xs sm:text-sm rounded-full border border-gray-200 bg-[#fffef7]">
            <span>üìö</span><span>–£—Ä–æ–∫–∏</span>
          </button>
          <button data-tab="vocab" class="mode-btn inline-flex items-center gap-2 px-4 py-2 text-xs sm:text-sm rounded-full border border-gray-200 bg-[#fffef7]">
            <span>üß†</span><span>–°–ª–æ–≤–∞—Ä–∏–∫</span>
          </button>
          <button data-tab="exercises" class="mode-btn inline-flex items-center gap-2 px-4 py-2 text-xs sm:text-sm rounded-full border border-gray-200 bg-[#fffef7]">
            <span>üéØ</span><span>–£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</span>
          </button>
          <button data-tab="practice" class="mode-btn inline-flex items-center gap-2 px-4 py-2 text-xs sm:text-sm rounded-full border border-gray-200 bg-[#fffef7]">
            <span>üí¨</span><span>–ü—Ä–∞–∫—Ç–∏–∫–∞</span>
          </button>
          <button data-tab="pro" class="mode-btn inline-flex items-center gap-2 px-4 py-2 text-xs sm:text-sm rounded-full border border-gray-200 bg-[#fffef7]">
            <span>‚ú®</span><span>PRO-–¥–æ—Å—Ç—É–ø</span>
          </button>
        </div>

        <!-- –í–ö–õ–ê–î–ö–ê: –£—Ä–æ–∫–∏ -->
        <div id="tab-lessons" class="tab-panel">
          <div>
            <h2 class="text-base sm:text-lg font-extrabold mb-2">–£—Ä–æ–∫–∏ –∫—É—Ä—Å–∞</h2>
            <p class="text-xs sm:text-sm text-[var(--ink-2)] mb-4">
              –ö–∞–∂–¥—ã–π —É—Ä–æ–∫ ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ç–µ–∫—Å—Ç–æ–º, –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏, –≤–∏–¥–µ–æ –∏ –∑–∞–¥–∞–Ω–∏—è–º–∏. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å 10‚Äì15 –º–∏–Ω—É—Ç.
            </p>
            <div id="lessons-list" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-3 text-sm text-[var(--ink-2)]"></div>
          </div>
        </div>

        <!-- –í–ö–õ–ê–î–ö–ê: –°–ª–æ–≤–∞—Ä–∏–∫ -->
        <div id="tab-vocab" class="tab-panel hidden">
          <div class="grid md:grid-cols-[2fr,1fr] gap-6 items-start text-sm text-[var(--ink-2)]">
            <div>
              <h2 class="text-base sm:text-lg font-extrabold mb-2">–°–ª–æ–≤–∞—Ä–∏–∫ –∫—É—Ä—Å–∞</h2>
              <p class="text-xs sm:text-sm text-[var(--ink-2)] mb-3">
                –í —Å–ª–æ–≤–∞—Ä–∏–∫ –ø–æ–ø–∞–¥–∞—é—Ç —Å–ª–æ–≤–∞ –∏–∑ —É—Ä–æ–∫–æ–≤ –∏ —Ç–µ, —á—Ç–æ –≤—ã –¥–æ–±–∞–≤–∏—Ç–µ —Å–∞–º–∏. –ï—Å–ª–∏ –≤—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã, —Å–ª–æ–≤–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –≤–∞—à–µ–º –ø—Ä–æ—Ñ–∏–ª–µ.
              </p>
              <div id="vocab-list" class="max-h-80 overflow-auto divide-y divide-gray-100 text-xs sm:text-sm"></div>
            </div>
            <div class="bg-[#fffef7] border border-gray-200 rounded-2xl p-4 text-xs sm:text-sm">
              <h3 class="font-semibold mb-2">–î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ—ë —Å–ª–æ–≤–æ</h3>
              <form id="vocab-form" class="space-y-2">
                <div>
                  <label class="block text-[11px] mb-1">–°–ª–æ–≤–æ –ø–æ-–∞–Ω–≥–ª–∏–π—Å–∫–∏</label>
                  <input name="word" class="w-full border border-gray-200 rounded-xl px-3 py-2 text-sm" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, notebook">
                </div>
                <div>
                  <label class="block text-[11px] mb-1">–ü–µ—Ä–µ–≤–æ–¥</label>
                  <input name="translation" class="w-full border border-gray-200 rounded-xl px-3 py-2 text-sm" placeholder="–±–ª–æ–∫–Ω–æ—Ç / –Ω–æ—É—Ç–±—É–∫">
                </div>
                <button class="mt-1 px-4 py-2 rounded-xl bg-[var(--brand-yellow)] hover:bg-[var(--brand-yellow-deep)] text-xs font-semibold text-[#1a1a1a] shadow-soft">
                  ‚ûï –î–æ–±–∞–≤–∏—Ç—å –≤ —Å–ª–æ–≤–∞—Ä–∏–∫
                </button>
              </form>
              <p class="mt-3 text-[11px] text-[var(--ink-2)]">
                –ü–æ–∑–∂–µ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç —Å–≤—è–∑–∞—Ç—å —Å–ª–æ–≤–∞—Ä–∏–∫ —Å –ª–∏—á–Ω—ã–º –∫–∞–±–∏–Ω–µ—Ç–æ–º –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞–º–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.
              </p>
            </div>
          </div>
        </div>

        <!-- –í–ö–õ–ê–î–ö–ê: –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è (React) -->
        <div id="tab-exercises" class="tab-panel hidden">
          <!-- —Å—é–¥–∞ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è React-–∏–≥—Ä–∞ -->
          <div id="practice-react-root"></div>
        </div>

        <!-- –í–ö–õ–ê–î–ö–ê: –ü—Ä–∞–∫—Ç–∏–∫–∞ —è–∑—ã–∫–∞ –≤ –∂–∏–∑–Ω–∏ (–±–µ–∑ React) -->
        <div id="tab-practice" class="tab-panel hidden">
          <div class="grid md:grid-cols-[2fr,1fr] gap-6 items-start text-sm text-[var(--ink-2)]">
            <div>
              <h2 class="text-base sm:text-lg font-extrabold mb-2">–ü—Ä–∞–∫—Ç–∏–∫–∞ —è–∑—ã–∫–∞ –≤ –∂–∏–∑–Ω–∏</h2>
              <p class="text-xs sm:text-sm mb-3">
                –ó–¥–µ—Å—å ‚Äî –ø—Ä–æ—Å—Ç—ã–µ –∏–¥–µ–∏, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–Ω–≥–ª–∏–π—Å–∫–∏–π –≤–Ω–µ —É—Ä–æ–∫–æ–≤. –ú–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ø—Ä–æ—Å—Ç–æ –¥–ª—è —Å–µ–±—è, –±–µ–∑ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –æ—Ç—á—ë—Ç–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–æ–∫.
              </p>
              <div id="practice-idea" class="border border-gray-200 rounded-2xl px-3 py-3 text-xs bg-[#fffef7]"></div>
              <button id="practice-next" class="mt-3 px-4 py-2 rounded-xl border border-gray-200 bg-white text-xs font-semibold">
                –î—Ä—É–≥–∞—è –∏–¥–µ—è –ø—Ä–∞–∫—Ç–∏–∫–∏
              </button>
            </div>
            <div class="bg-[#fffef7] border border-gray-200 rounded-2xl p-4 text-xs sm:text-sm space-y-2">
              <h3 class="font-semibold mb-1">–î–ª—è –∫–æ–≥–æ —ç—Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞</h3>
              <p>–î–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç –º—è–≥–∫–æ –≤—Å—Ç—Ä–æ–∏—Ç—å –∞–Ω–≥–ª–∏–π—Å–∫–∏–π –≤ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ—Å—Ç—å: –≥–æ–ª–æ—Å–æ–≤—ã–µ, –º–∏–Ω–∏-—Ç–µ–∫—Å—Ç—ã, –ø–æ–¥–ø–∏—Å–∏ –∫ —Ñ–æ—Ç–æ, –∑–∞–º–µ—Ç–∫–∏.</p>
              <p class="text-[11px] text-[var(--ink-2)]">
                –ï—Å–ª–∏ –∑–∞—Ö–æ—á–µ—Ç—Å—è, —á—Ç–æ–±—ã –∑–∞–¥–∞–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—è–ª –∂–∏–≤–æ–π —á–µ–ª–æ–≤–µ–∫ ‚Äî —ç—Ç–æ —É–∂–µ —á–∞—Å—Ç—å <b>PRO-–¥–æ—Å—Ç—É–ø–∞</b> –≤–æ –≤–∫–ª–∞–¥–∫–µ –≤—ã—à–µ.
              </p>
            </div>
          </div>
        </div>

        <!-- –í–ö–õ–ê–î–ö–ê: PRO-–¥–æ—Å—Ç—É–ø -->
        <div id="tab-pro" class="tab-panel hidden">
          <div class="grid md:grid-cols-[2fr,1fr] gap-6 items-start text-sm text-[var(--ink-2)]">
            <div>
              <h2 class="text-base sm:text-lg font-extrabold mb-2">PRO-–¥–æ—Å—Ç—É–ø –∏ –ø–ª–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</h2>
              <p class="text-xs sm:text-sm mb-3">
                –ë–∞–∑–æ–≤—ã–π –¥–æ—Å—Ç—É–ø –∫ —É—Ä–æ–∫–∞–º, —Å–ª–æ–≤–∞—Ä—é –∏ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–∞–º –æ—Å—Ç–∞—ë—Ç—Å—è –±–µ—Å–ø–ª–∞—Ç–Ω—ã–º. PRO –¥–æ–±–∞–≤–ª—è–µ—Ç –∫—É—Ä–∞—Ç–æ—Ä–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞–¥–∞–Ω–∏–π –∏ –±–æ–ª—å—à–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏.
              </p>

              <div class="border border-gray-200 rounded-2xl px-3 py-3 bg-white space-y-2">
                <p class="font-semibold mb-1">üßë‚Äçüè´ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–¥–∞–Ω–∏–π –∫—É—Ä–∞—Ç–æ—Ä–æ–º</p>
                <p>–í—ã –≤—ã–ø–æ–ª–Ω—è–µ—Ç–µ –ø–∏—Å—å–º–µ–Ω–Ω—ã–µ –∏ –≥–æ–ª–æ—Å–æ–≤—ã–µ –∑–∞–¥–∞–Ω–∏—è, –∞ –∫—É—Ä–∞—Ç–æ—Ä –ø—Ä–∏—Å—ã–ª–∞–µ—Ç —Ä–∞–∑–±–æ—Ä, –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –æ—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –±–æ–ª–µ–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏.</p>
              </div>

              <div class="border border-gray-200 rounded-2xl px-3 py-3 bg-white space-y-2 mt-3">
                <p class="font-semibold mb-1">üìÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫—É—Ä–∞—Ç–æ—Ä—É –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è</p>
                <p>–í—ã —Å–º–æ–∂–µ—Ç–µ –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å—Å—è –µ—â—ë –±–æ–ª—å—à–µ –∏ —É–∑–Ω–∞–≤–∞—Ç—å: —á—Ç–æ —É–∂–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å, –∞ –Ω–∞ —á—ë–º –ª—É—á—à–µ —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–∞–ª—å—à–µ.</p>
              </div>
            </div>

            <div class="bg-[#fffef7] border border-gray-200 rounded-2xl p-4 text-xs sm:text-sm space-y-2">
              <h3 class="font-semibold mb-1">–û—Ñ–æ—Ä–º–∏—Ç—å PRO</h3>
              <p>–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç, –∑–∞—Ç–µ–º –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –Ω–∞ —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É.</p>

              <!-- –ø—Ä–æ—Å—Ç–æ —Å—Å—ã–ª–∫–∞ –Ω–∞ /courses/pro.html -->
              <a
                href="/courses/pro.html"
                class="mt-2 w-full inline-flex items-center justify-center gap-2 px-4 py-2 rounded-xl bg-[var(--brand-orange)] hover:bg-[var(--brand-yellow-deep)] text-xs sm:text-sm font-semibold text-white shadow-soft"
              >
                ‚ú® –û—Ñ–æ—Ä–º–∏—Ç—å PRO-–¥–æ—Å—Ç—É–ø
              </a>

              <p class="mt-1 text-[10px] text-[var(--ink-2)]">
                –ï—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∏–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É ‚Äî –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ.
              </p>
            </div>
          </div>
        </div>

      </div>
    </div>
  </section>
</main>

<!-- FOOTER: –±–æ–ª–µ–µ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π –¥–ª—è –∫—É—Ä—Å–∞ -->
<footer class="border-t border-gray-200 bg-white/80 backdrop-blur py-10 text-sm text-gray-700 mt-4">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid grid-cols-1 md:grid-cols-3 gap-8">
    <div>
      <a href="/" class="inline-flex items-center gap-2 font-semibold text-gray-900">
        <img src="/assets/logo.png" alt="PolyTalky" class="h-8 w-8 rounded-xl">
        <span>PolyTalky ¬∑ English Intro</span>
      </a>
      <p class="mt-3 text-gray-500">–ê–Ω–≥–ª–∏–π—Å–∫–∏–π –¥–ª—è –∂–∏–∑–Ω–∏: –∫–æ—Ä–æ—Ç–∫–∏–µ —É—Ä–æ–∫–∏, –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ø—Ä–∞–∫—Ç–∏–∫–∞ –±–µ–∑ —Å—Ç—Ä–µ—Å—Å–∞.</p>
      <p class="mt-4 text-gray-400">¬© 2025 PolyTalky. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
    </div>
    <div>
      <h3 class="font-semibold text-gray-900 mb-3">–†–∞–∑–¥–µ–ª—ã —Å–∞–π—Ç–∞</h3>
      <ul class="space-y-2">
        <li><a href="/courses/" class="hover:underline">–í—Å–µ –∫—É—Ä—Å—ã</a></li>
        <li><a href="/shop/" class="hover:underline">–ú–∞–≥–∞–∑–∏–Ω</a></li>
        <li><a href="/student/" class="hover:underline">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a></li>
        <li><a href="/contact.html" class="hover:underline">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
      </ul>
    </div>
    <div>
      <h3 class="font-semibold text-gray-900 mb-3">–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
      <ul class="space-y-2">
        <li><a href="/legal/privacy.html" class="hover:underline">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a></li>
        <li><a href="/legal/offer.html" class="hover:underline">–ü—É–±–ª–∏—á–Ω–∞—è –æ—Ñ–µ—Ä—Ç–∞</a></li>
        <li><a href="/legal/cookies.html" class="hover:underline">Cookies</a></li>
        <li><a href="/legal/consent.html" class="hover:underline">–°–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö</a></li>
      </ul>
    </div>
  </div>
</footer>

<!-- Stripe.js –¥–ª—è Checkout -->
<script src="https://js.stripe.com/v3"></script>
 <!-- Firebase init -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { getFirestore } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBAU_uMTePpKwVNZNhqk2pss2PuSitGfQI",
      authDomain: "polytalky-70999.firebaseapp.com",
      projectId: "polytalky-70999",
      storageBucket: "polytalky-70999.firebasestorage.app",
      messagingSenderId: "62407152289",
      appId: "1:62407152289:web:b0c0efdb2472f12b10d6e0"
    };

    window.firebaseApp  = initializeApp(firebaseConfig);
    window.firebaseAuth = getAuth(window.firebaseApp);
    window.firebaseDb   = getFirestore(window.firebaseApp);
  </script>

<!-- –õ–û–ì–ò–ö–ê –°–¢–†–ê–ù–ò–¶–´ –ö–ê–ö –ú–û–î–£–õ–¨ -->
<script type="module">
  // Firebase Auth + Firestore
  import {
    onAuthStateChanged
  } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

  import {
    collection,
    query,
    where,
    getDocs,
    doc,
    getDoc,
    setDoc
  } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –∏–∑ firebaseInit.js (–µ—Å–ª–∏ –æ–Ω –ø–æ–¥–∫–ª—é—á—ë–Ω)
  const auth = window.firebaseAuth || null;
  const db   = window.firebaseDb   || null;

  const COURSE_ID = "english-intro";

  // -----------------------------------
  // –ë–£–†–ì–ï–†-–ú–ï–ù–Æ
  // -----------------------------------
  const b = document.getElementById('burger');
  const m = document.getElementById('mnav');
  if (b && m) {
    b.addEventListener('click', () => m.classList.toggle('hidden'));
  }

  // -----------------------------------
  // –û–ü–ò–°–ê–ù–ò–ï –£–†–û–ö–û–í
  // -----------------------------------
    // ID –∑–¥–µ—Å—å –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å lessonId –≤ window.lessonConfig –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö —É—Ä–æ–∫–æ–≤
  const courseLessons = [
    {
      id: "english-intro-lesson-1",
      title: "–£—Ä–æ–∫ 1 ¬∑ –ì–ª–∞—Å–Ω—ã–µ –±—É–∫–≤—ã –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ –∏ –±—É–∫–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è",
      minutes: 10,
      url: "/courses/english-intro/lesson-01-hello.html"
    },
    {
      id: "english-intro-lesson-2",
      title: "–£—Ä–æ–∫ 2 ¬∑ –°–æ–≥–ª–∞—Å–Ω—ã–µ –±—É–∫–≤—ã –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ –∏ –±—É–∫–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è",
      minutes: 12,
      url: "/courses/english-intro/lesson-02-intro.html"
    },
    {
      id: "english-intro-lesson-3",
      title: "–£—Ä–æ–∫ 3 ¬∑ –ü–æ—Ä—è–¥–æ–∫ —Å–ª–æ–≤ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ –∏ –≥–ª–∞–≥–æ–ª to be",
      minutes: 15,
      url: "/courses/english-intro/lesson-03.html"
    },
    {
      id: "english-intro-lesson-4",
      title: "–£—Ä–æ–∫ 4 ¬∑ –í—Ä–µ–º–µ–Ω–∞ (Simple / Continuous / Perfect)",
      minutes: 15,
      url: "/courses/english-intro/lesson-04.html"
    },
    {
      id: "english-intro-lesson-5",
      title: "–£—Ä–æ–∫ 5 ¬∑ –ö—É–ª—å—Ç—É—Ä–Ω—ã–π —Ñ–µ–Ω–æ–º–µ–Ω",
      minutes: 5,
      url: "/courses/english-intro/lesson-05.html"
    },
     {
      id: "english-intro-lesson-6",
      title: "–£—Ä–æ–∫ 6 ¬∑ Present Simple",
      minutes: 10,
      url: "/courses/english-intro/lesson-06.html"
    },
     {
      id: "english-intro-lesson-7",
      title: "–£—Ä–æ–∫ 7 ¬∑ –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è",
      minutes: 10,
      url: "/courses/english-intro/lesson-07.html"
    },
    {
      id: "english-intro-lesson-8",
      title: "–£—Ä–æ–∫ 8 ¬∑ –í–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è",
      minutes: 10,
      url: "/courses/english-intro/lesson-08.html"
    },
     {
      id: "english-intro-lesson-9",
      title: "–£—Ä–æ–∫ 9 ¬∑ –ó–≤—É–∫ TH",
      minutes: 10,
      url: "/courses/english-intro/lesson-09.html"
    }
  ];

  // -----------------------------------
  // –õ–û–ö–ê–õ–¨–ù–û–ï –°–û–°–¢–û–Ø–ù–ò–ï (–¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö)
  // -----------------------------------
  function loadLocalState() {
    try {
      return {
        xp: Number(localStorage.getItem("local_intro_xp") || 0),
        streakDays: Number(localStorage.getItem("local_intro_streak") || 0),
        completedLessons: JSON.parse(localStorage.getItem("local_intro_completed_lessons") || "[]"),
        vocab: JSON.parse(localStorage.getItem("local_intro_vocab") || "[]")
      };
    } catch (e) {
      console.warn("Local load error", e);
      return { xp:0, streakDays:0, completedLessons:[], vocab:[] };
    }
  }

  function saveLocalState(state) {
    localStorage.setItem("local_intro_xp", String(state.xp || 0));
    localStorage.setItem("local_intro_streak", String(state.streakDays || 0));
    localStorage.setItem(
      "local_intro_completed_lessons",
      JSON.stringify(state.completedLessons || [])
    );
    localStorage.setItem(
      "local_intro_vocab",
      JSON.stringify(state.vocab || [])
    );
  }

  function localAddVocab(word, translation) {
    const s = loadLocalState();
    s.vocab.push({ word, translation, lessonId:"user" });
    saveLocalState(s);
  }

  // -----------------------------------
  // –ì–õ–û–ë–ê–õ–¨–ù–û–ï –°–û–°–¢–û–Ø–ù–ò–ï –°–¢–†–ê–ù–ò–¶–´
  // -----------------------------------
  let currentUser     = null;
  let currentUserKey  = null;
  let appState = {
    xp: 0,
    streakDays: 0,
    completedLessons: [],
    vocab: [],
    isFromFirebase: false
  };

  let currentVocab = [];

  // -----------------------------------
  // DOM-–°–°–´–õ–ö–ò –î–õ–Ø –°–¢–ê–¢–´
  // -----------------------------------
  const statLevel    = document.getElementById("stat-level");
  const statXp       = document.getElementById("stat-xp");
  const statStreak   = document.getElementById("stat-streak");
  const progressText = document.getElementById("progress-text");
  const progressBar  = document.getElementById("progress-bar");
  const badgeRow     = document.getElementById("badge-row");
  // –≠–ª–µ–º–µ–Ω—Ç—ã —à–∞–ø–∫–∏: –≤—Ö–æ–¥ / email
  const headerLoginLink       = document.getElementById("header-login-link");
  const headerEmailLabel      = document.getElementById("header-email");
  const headerLoginLinkMobile = document.getElementById("header-login-link-mobile");
  const headerEmailMobile     = document.getElementById("header-email-mobile");

  // –ë–µ–π–¥–∂–∏ –∫—É—Ä—Å–∞ English Intro: id ‚Üí –∫–∞—Ä—Ç–∏–Ω–∫–∞ + –ø–æ–¥–ø–∏—Å—å
  const BADGE_META = {
    // –µ—Å–ª–∏ –≤ Firestore id "english-intro-lesson1"
    "english-intro-lesson1": {
      label: "–ü–µ—Ä–≤—ã–π —É—Ä–æ–∫",
      img: "/assets/badges/english-intro-lesson1.png"
    },
    // –µ—Å–ª–∏ –≤–æ –≤—Ç–æ—Ä–æ–º –±–µ–π–¥–∂–µ id "rickrolling"
    "rickrolling": {
      label: "Rickrolling",
      img: "/assets/badges/rickrolling.png"
    }
    // –µ—Å–ª–∏ id –¥—Ä—É–≥–∏–µ ‚Äî –ø—Ä–æ—Å—Ç–æ –ø–æ–º–µ–Ω—è–π –∫–ª—é—á–∏ –Ω–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
  };
  const COURSE_BADGE_IDS = new Set([ 
    "english-intro-lesson1", 
    "rickrolling",
    ]);
  // -----------------------------------
  // –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ –†–ï–ñ–ò–ú–û–í (–≤–∫–ª–∞–¥–∫–∏)
  // -----------------------------------
  const modeButtons = document.querySelectorAll(".mode-btn");
  const panels = {
    lessons:   document.getElementById("tab-lessons"),
    vocab:     document.getElementById("tab-vocab"),
    exercises: document.getElementById("tab-exercises"),
    practice:  document.getElementById("tab-practice"),
    pro:       document.getElementById("tab-pro")
  };

  modeButtons.forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const tab = btn.dataset.tab;
      modeButtons.forEach(b=>b.classList.remove("mode-btn-active"));
      btn.classList.add("mode-btn-active");
      Object.entries(panels).forEach(([name,el])=>{
        if (!el) return;
        if (name === "exercises") {
  // React-—É–∑–µ–ª –ù–ï —Å–∫—Ä—ã–≤–∞–µ–º, —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
  el.style.display = (name === tab) ? "block" : "block";
  const inner = el.firstElementChild;
  if (inner) inner.style.display = (name === tab) ? "block" : "none";
} else {
  // –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏ —Å–∫—Ä—ã–≤–∞–µ–º –æ–±—ã—á–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º
  el.classList.toggle("hidden", name !== tab);
}
      });
    });
  });

  // -----------------------------------
  // –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò FIREBASE
  // -----------------------------------
  function makeUserKey(user) {
    if (!user) return null;
    if (user.email) return user.email.toLowerCase();
    return user.uid;
  }

async function loadStateFromFirebaseOrMigrate(userKey) {
  if (!db || !userKey) {
    const local = loadLocalState();
    appState = {
      xp: local.xp,
      streakDays: local.streakDays,
      completedLessons: local.completedLessons,
      vocab: local.vocab,
      badges: [],
      isFromFirebase: false
    };
    currentVocab = appState.vocab;
    console.log("[Intro] Firebase –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Ä–∞–±–æ—Ç–∞–µ–º –∏–∑ localStorage");
    return;
  }

  const local = loadLocalState();
  let xp = 0;
  let streakDays = 0;
  let badges = [];

  try {
    // ---------- users/{userKey} ----------
    const userRef = doc(db, "users", userKey);
    const userSnap = await getDoc(userRef);

    if (userSnap.exists()) {
      const data = userSnap.data() || {};
      const hasXpField = Object.prototype.hasOwnProperty.call(data, "xp");

      xp = data.xp || 0;
      streakDays = data.streakDays || 0;
      badges = Array.isArray(data.badges) ? data.badges : [];

      // –º–∏–≥—Ä–∞—Ü–∏—è –∏–∑ localStorage, –µ—Å–ª–∏ –Ω–∞–¥–æ
      if (!hasXpField && local.xp > 0) {
        xp = local.xp;
        streakDays = local.streakDays || 0;
        await setDoc(
          userRef,
          {
            xp,
            streakDays,
            lastStudyDate: new Date().toISOString().slice(0, 10)
          },
          { merge: true }
        );
      }
    } else {
      // –î–æ–∫—É–º–µ–Ω—Ç–∞ –Ω–µ—Ç ‚Äî —Å–æ–∑–¥–∞—ë–º –ø–æ –ª–æ–∫–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º
      xp = local.xp || 0;
      streakDays = local.streakDays || 0;
      badges = [];
      await setDoc(
        userRef,
        {
          xp,
          streakDays,
          lastStudyDate: new Date().toISOString().slice(0, 10)
        },
        { merge: true }
      );
    }

    // ---------- progress ----------
    const progressCol = collection(db, "progress");
    const qProg = query(progressCol, where("userId", "==", userKey));
    const progSnap = await getDocs(qProg);

    const completedLessons = [];
    progSnap.forEach(docSnap => {
      const d = docSnap.data();
      if (d.lessonId && !completedLessons.includes(d.lessonId)) {
        completedLessons.push(d.lessonId);
      }
    });

    // ---------- vocabulary ----------
    const vocabCol = collection(db, "users", userKey, "vocabulary");
    const vsnap = await getDocs(vocabCol);

    const vocab = [];
    vsnap.forEach(vdoc => {
      const d = vdoc.data();
      if (!d.word) return;
      vocab.push({
        word: d.word,
        translation: d.translation || "",
        lessonId: d.lesson || "user"
      });
    });

    appState = {
      xp,
      streakDays,
      completedLessons,
      vocab,
      badges,
      isFromFirebase: true
    };
    currentVocab = appState.vocab;

    console.log("[Intro] –ó–∞–≥—Ä—É–∂–µ–Ω–æ –∏–∑ Firebase:", {
      xp,
      streakDays,
      lessons: completedLessons.length,
      vocab: vocab.length,
      badges: badges.length
    });

  } catch (e) {
    console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–∑ Firebase, fallback –∫ localStorage:", e);
    const local2 = loadLocalState();
    appState = {
      xp: local2.xp,
      streakDays: local2.streakDays,
      completedLessons: local2.completedLessons,
      vocab: local2.vocab,
      badges: [],
      isFromFirebase: false
    };
    currentVocab = appState.vocab;
  }
}

  // -----------------------------------
  // –†–ï–ù–î–ï–† –°–¢–ê–¢–´
  // -----------------------------------
function updateStats() {
  const level = 1 + Math.floor((appState.xp || 0) / 100);
  if (statLevel) statLevel.textContent  = String(level);
  if (statXp)    statXp.textContent     = String(appState.xp || 0);

  const streak = appState.streakDays || 0;
  if (statStreak) statStreak.textContent = streak + " –¥–Ω–µ–π";

  const total = courseLessons.length;
  const done  = courseLessons.filter(l => (appState.completedLessons || []).includes(l.id)).length;
  const percent = total ? Math.round((done / total) * 100) : 0;


  if (progressText) progressText.textContent = `${done} / ${total}`;
  if (progressBar)  progressBar.style.width  = percent + "%";

  // ---- –ë–ï–ô–î–ñ–ò ----
  if (!badgeRow) return;
  badgeRow.innerHTML = "";

  const allUserBadges = Array.isArray(appState.badges) ? appState.badges : [];
  const userBadges = allUserBadges.filter(
    (id) => COURSE_BADGE_IDS.has(id) && BADGE_META[id] );

  if (!userBadges.length) {
    const p = document.createElement("p");
    p.className = "text-[10px] text-[var(--ink-2)]";
    p.textContent = "–ü—Ä–æ–π–¥–∏—Ç–µ –ø–µ—Ä–≤—ã–π —É—Ä–æ–∫, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–≤–æ–π –ø–µ—Ä–≤—ã–π –±–µ–π–¥–∂ üéñ";
    badgeRow.appendChild(p);
    return;
  }

  userBadges.forEach(id => {
    const meta = BADGE_META[id] || {
      label: id,
      img: "/assets/badges/" // —Ç–≤–æ—è –¥–µ—Ñ–æ–ª—Ç–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞
    };

    const wrap = document.createElement("div");
    wrap.className = "flex flex-col items-center text-[10px]";

    const circle = document.createElement("div");
    circle.className =
      "h-10 w-10 rounded-full bg-white flex items-center justify-center shadow-soft overflow-hidden border border-gray-200";

    const img = document.createElement("img");
    img.src = meta.img;
    img.alt = meta.label;
    img.className = "h-8 w-8 object-contain";

    circle.appendChild(img);

    const caption = document.createElement("span");
    caption.className =
      "mt-1 text-[10px] text-[var(--ink-2)] text-center max-w-[88px]";
    caption.textContent = meta.label;

    wrap.appendChild(circle);
    wrap.appendChild(caption);
    badgeRow.appendChild(wrap);
  });
}

    // -----------------------------------
  // –°–ü–ò–°–û–ö –£–†–û–ö–û–í
  // -----------------------------------
  function renderLessons(){
    const box = document.getElementById("lessons-list");
    if (!box) return;
    box.innerHTML = "";
    const completed = appState.completedLessons || [];

    courseLessons.forEach((lesson, index)=>{
      const isDone = completed.includes(lesson.id);
      const card = document.createElement("a");
      card.href = lesson.url;
      card.className = "block border border-gray-200 rounded-2xl px-3 py-3 bg-white hover:bg-[#fff7ce] transition-colors text-xs sm:text-sm";
      card.innerHTML = `
        <div class="flex items-center justify-between gap-2 mb-1">
          <div class="flex items-center gap-2">
            <span class="inline-flex h-6 w-6 rounded-full text-[11px] items-center justify-center ${isDone ? "bg-emerald-500 text-white" : "bg-gray-100 text-gray-500"}">
              ${isDone ? "‚úì" : String(index + 1).padStart(2, "0")}
            </span>
            <span class="font-semibold text-[var(--ink)] line-clamp-1">${lesson.title}</span>
          </div>
          <span class="text-[10px] text-[var(--ink-2)]">${lesson.minutes} –º–∏–Ω</span>
        </div>
        <p class="text-[11px] text-[var(--ink-2)]">–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —É—Ä–æ–∫–∞.</p>
      `;
      box.appendChild(card);
    });
  }

  // -----------------------------------
  // –°–õ–û–í–ê–†–ò–ö
  // -----------------------------------
  function renderVocab(){
    const box  = document.getElementById("vocab-list");
    if (!box) return;
    const list = currentVocab || [];
    box.innerHTML = "";
    if(!list.length){
      box.innerHTML = `<p class="py-2 text-xs text-[var(--ink-2)]">–ü–æ–∫–∞ –ø—É—Å—Ç–æ. –ü—Ä–æ–π–¥–∏—Ç–µ –ø–∞—Ä—É —É—Ä–æ–∫–æ–≤ –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–ª–æ–≤–∞ –≤—Ä—É—á–Ω—É—é.</p>`;
      return;
    }
    list.forEach(item=>{
      if (!item.word) return;
      const div = document.createElement("div");
      div.className = "flex items-baseline justify-between gap-2 py-1.5";
      div.innerHTML = `
        <div>
          <p><b>${item.word}</b> ‚Äî ${item.translation || ""}</p>
          ${item.lessonId && item.lessonId !== "user"
            ? `<p class="text-[10px] text-[var(--ink-2)]">–ò–∑ —É—Ä–æ–∫–∞: ${item.lessonId}</p>`
            : ""
          }
        </div>
      `;
      box.appendChild(div);
    });
  }

  const vocabForm = document.getElementById("vocab-form");
  if (vocabForm) {
    vocabForm.addEventListener("submit", async (e)=>{
      e.preventDefault();
      const form = e.target;
      const word = form.word.value.trim();
      const translation = form.translation.value.trim();
      if(!word || !translation) return;

      if (currentUser && db) {
        // –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π: —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Firestore
        try {
          const userKey = currentUserKey || makeUserKey(currentUser);
          if (!userKey) throw new Error("–ù–µ—Ç userKey");

          const colRef = collection(db, "users", userKey, "vocabulary");
          // doc(colRef) ‚Äî —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π ID
          await setDoc(
            doc(colRef),
            {
              word,
              translation,
              lesson: "user",
              courseId: COURSE_ID,
              category: "",
              addedAt: new Date()
            }
          );

          appState.vocab.push({ word, translation, lessonId:"user" });
          currentVocab = appState.vocab;
          window.currentVocab = currentVocab;
  window.dispatchEvent(
    new CustomEvent("pt-vocab-updated", { detail: { vocab: currentVocab } })
    );

        } catch (err) {
          console.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–ª–æ–≤–∞ –≤ Firestore:", err);
          // fallback ‚Äî localStorage
          localAddVocab(word, translation);
          const local = loadLocalState();
          appState.vocab = local.vocab;
          currentVocab   = appState.vocab;
        }
      } else {
        // –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π: —Ç–æ–ª—å–∫–æ localStorage
        localAddVocab(word, translation);
        const local = loadLocalState();
        appState.vocab = local.vocab;
        currentVocab   = appState.vocab;
      }

      form.reset();
      renderVocab();
    });
  }

  // -----------------------------------
  // –ü–†–ê–ö–¢–ò–ö–ê
  // -----------------------------------
  const practiceIdeas = [
    "–ó–∞–ø–∏—à–∏—Ç–µ –≥–æ–ª–æ—Å–æ–≤–æ–µ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω, –≥–¥–µ –≤—ã –∑–¥–æ—Ä–æ–≤–∞–µ—Ç–µ—Å—å, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç–µ—Å—å –∏ –≥–æ–≤–æ—Ä–∏—Ç–µ, –∏–∑ –∫–∞–∫–æ–≥–æ –≤—ã –≥–æ—Ä–æ–¥–∞.",
    "–ù–∞–ø–∏—à–∏—Ç–µ –º–∏–Ω–∏-–¥–∏–∞–ª–æ–≥ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ –∏–∑ 4‚Äì6 —Ä–µ–ø–ª–∏–∫ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –µ–≥–æ –≤—Å–ª—É—Ö —Å —Ä–∞–∑–Ω–æ–π –∏–Ω—Ç–æ–Ω–∞—Ü–∏–µ–π.",
    "–í—ã–±–µ—Ä–∏—Ç–µ 3 –ø—Ä–µ–¥–º–µ—Ç–∞ –≤–æ–∫—Ä—É–≥ –∏ –ø–æ–¥–ø–∏—à–∏—Ç–µ –∏—Ö –ø–æ-–∞–Ω–≥–ª–∏–π—Å–∫–∏ (–≤ –∑–∞–º–µ—Ç–∫–∞—Ö –∏–ª–∏ —Å—Ç–∏–∫–µ—Ä–∞–º–∏).",
    "–°–¥–µ–ª–∞–π—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤—É—é –∑–∞–º–µ—Ç–∫—É ¬´–ú–æ—ë —É—Ç—Ä–æ¬ª –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º: 3‚Äì5 –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –≤ Present Simple."
  ];
  const practiceBox = document.getElementById("practice-idea");
  function renderPracticeIdea(){
    if (!practiceBox) return;
    const idea = practiceIdeas[Math.floor(Math.random()*practiceIdeas.length)];
    practiceBox.textContent = idea;
  }
  const practiceNext = document.getElementById("practice-next");
  if (practiceNext) {
    practiceNext.addEventListener("click", renderPracticeIdea);
  }

  // -----------------------------------
  // –ö–ù–û–ü–ö–ê "–ü–†–û–î–û–õ–ñ–ò–¢–¨"
  // -----------------------------------
  function getLastLessonIdFromState() {
    const completed = appState.completedLessons || [];
    if (!completed.length) return null;

    let lastId = null;
    let bestIndex = -1;
    courseLessons.forEach((l, idx) => {
      if (completed.includes(l.id) && idx > bestIndex) {
        bestIndex = idx;
        lastId = l.id;
      }
    });
    return lastId;
  }

  const btnContinue = document.getElementById("btn-continue");
  function updateStartContinueButtons() {
    const btnStart = document.getElementById("btn-start");
    const btnContinueEl = document.getElementById("btn-continue");
    if (!btnStart || !btnContinueEl) return;

    const doneCount = (appState.completedLessons || []).length;

    if (doneCount === 0) {
      // –ö—É—Ä—Å –µ—â—ë –Ω–µ –Ω–∞—á–∏–Ω–∞–ª–∏: –ø–æ–∫–∞–∑—ã–≤–∞–µ–º "–ù–∞—á–∞—Ç—å –∫—É—Ä—Å"
      btnStart.classList.remove("hidden");
      btnContinueEl.classList.add("hidden");
    } else {
      // –£–∂–µ —á—Ç–æ-—Ç–æ –ø—Ä–æ–π–¥–µ–Ω–æ: –ø–æ–∫–∞–∑—ã–≤–∞–µ–º "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"
      btnStart.classList.add("hidden");
      btnContinueEl.classList.remove("hidden");
    }
  }
  if (btnContinue) {

    btnContinue.addEventListener("click", ()=>{
      const lastId = getLastLessonIdFromState();
      if(lastId){
        const lesson = courseLessons.find(l=>l.id===lastId);
        if(lesson){
          window.location.href = lesson.url;
          return;
        }
      }
      if(courseLessons.length){
        window.location.href = courseLessons[0].url;
      }
    });
  }

    

  // -----------------------------------
  // Stripe / PRO
  // -----------------------------------
  async function getCurrentUid() {
    let uid = localStorage.getItem('pt_uid');
    if (uid) return uid;
    return null;
  }

  const proBtn = document.getElementById("btn-pro");
  if (proBtn) {
    proBtn.addEventListener("click", async () => {
      try {
        const uid = await getCurrentUid();

        if (!uid) {
          alert("–ß—Ç–æ–±—ã –æ—Ñ–æ—Ä–º–∏—Ç—å PRO, —Å–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ –≤–∞—à –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç, –∞ –∑–∞—Ç–µ–º –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –Ω–∞ —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É.");
          window.location.href = "/student/";
          return;
        }

        const resp = await fetch("/api/create-english-intro-pro-session", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ userId: uid })
        });

        if (!resp.ok) {
          alert("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –æ–ø–ª–∞—Ç—É. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑ —á—É—Ç—å –ø–æ–∑–∂–µ.");
          return;
        }

        const data = await resp.json();
        if (!data.id) {
          alert("–û—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –±–µ–∑ ID —Å–µ—Å—Å–∏–∏. –ù–∞–ø–∏—à–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É.");
          return;
        }

        if (!window.Stripe) {
          alert("–ü–ª–∞—Ç—ë–∂–Ω—ã–π –º–æ–¥—É–ª—å –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.");
          return;
        }

        const STRIPE_PK = "pk_live_51HqHTmBDwT3uzr4q884SspcgqeyUSp4esf81Z6tHnTkf66WJG1Z6b90PDtyXSdiEommSFnBpHEHswX2ks5Geq9G0004uLMLbKu";
        const stripe = Stripe(STRIPE_PK);
        const { error } = await stripe.redirectToCheckout({ sessionId: data.id });

        if (error) {
          console.error(error);
          alert("–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.");
        }
      } catch (e) {
        console.error(e);
        alert("–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑ –ø–æ–∑–∂–µ.");
      }
    });
  }

  // -----------------------------------
  // –û–ë–©–ò–ô –†–ï–ù–î–ï–†
  // -----------------------------------
    function renderAll() {
    currentVocab = appState.vocab || [];
      window.currentVocab = currentVocab;
   
    updateStats();
    renderLessons();
    renderVocab();
     renderPracticeIdea();
    updateStartContinueButtons();   // <- –¥–æ–±–∞–≤–∏–ª–∏
  }

  // -----------------------------------
  // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø: auth ‚Üí Firebase –∏–ª–∏ localStorage
  // -----------------------------------
if (auth && db) {
  onAuthStateChanged(auth, async (user) => {
    currentUser    = user;
    currentUserKey = makeUserKey(user);

    if (!user) {
      // --- —Ä–µ–∂–∏–º –≥–æ—Å—Ç—è ---
      const local = loadLocalState();
      appState = {
        xp: local.xp,
        streakDays: local.streakDays,
        completedLessons: local.completedLessons,
        vocab: local.vocab,
        isFromFirebase: false
      };
      currentVocab = appState.vocab || [];
      window.currentVocab = currentVocab;
      window.dispatchEvent(
        new CustomEvent("pt-vocab-updated", { detail: { vocab: currentVocab } })
      );

      console.log("[Intro] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, localStorage-—Ä–µ–∂–∏–º");
      console.log("[Intro] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, localStorage-—Ä–µ–∂–∏–º");

      // –•–µ–¥–µ—Ä: –ø–æ–∫–∞–∑—ã–≤–∞–µ–º "–í–æ–π—Ç–∏"
      if (headerLoginLink) {
        headerLoginLink.classList.remove("hidden");
      }
      if (headerEmailLabel) {
        headerEmailLabel.classList.add("hidden");
        headerEmailLabel.textContent = "";
      }
      if (headerLoginLinkMobile) {
        headerLoginLinkMobile.classList.remove("hidden");
      }
      if (headerEmailMobile) {
        headerEmailMobile.classList.add("hidden");
        headerEmailMobile.textContent = "";
      }

      renderAll();
    } else {
      // --- –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ—à—ë–ª ---
      await loadStateFromFirebaseOrMigrate(currentUserKey);

      currentVocab = appState.vocab || [];
      window.currentVocab = currentVocab;
      window.dispatchEvent(
        new CustomEvent("pt-vocab-updated", { detail: { vocab: currentVocab } })
      );
  
      const email = user.email || "";

      // –•–µ–¥–µ—Ä: —Å–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–í–æ–π—Ç–∏", –ø–æ–∫–∞–∑—ã–≤–∞–µ–º email
      if (headerLoginLink) {
        headerLoginLink.classList.add("hidden");
      }
      if (headerEmailLabel) {
        headerEmailLabel.textContent = email;
        headerEmailLabel.classList.remove("hidden");
      }

      if (headerLoginLinkMobile) {
        headerLoginLinkMobile.classList.add("hidden");
      }
      if (headerEmailMobile) {
        headerEmailMobile.textContent = email;
        headerEmailMobile.classList.remove("hidden");
      }

      renderAll();
    }
  });
} else {
    // Firebase –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º
    const local = loadLocalState();
    appState = {
      xp: local.xp,
      streakDays: local.streakDays,
      completedLessons: local.completedLessons,
      vocab: local.vocab,
      isFromFirebase: false
    };
    console.log("[Intro] FirebaseInit –Ω–µ –Ω–∞–π–¥–µ–Ω, –≤—Å—ë –±–µ—Ä—ë–º –∏–∑ localStorage");
  currentVocab = appState.vocab || [];
    window.currentVocab = currentVocab;
    window.dispatchEvent(
      new CustomEvent("pt-vocab-updated", { detail: { vocab: currentVocab } })
    );  
  renderAll();
  }
</script>
  <!-- React –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏ -->
<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

<script type="text/babel">
  const { useState, useEffect } = React;
 
  // –ü—Ä–∏–º–µ—Ä–Ω—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –¥–µ–º–æ (–µ—Å–ª–∏ –Ω–µ—Ç —Å–ª–æ–≤ –∏–∑ –∫—É—Ä—Å–∞)
  const DEMO_WORDS = [
    { word: 'hello',  translation: '–ø—Ä–∏–≤–µ—Ç',  transcription: '[h…ôÀàl…ô ä]' },
    { word: 'cat',    translation: '–∫–æ—Ç',     transcription: '[k√¶t]' },
    { word: 'dog',    translation: '—Å–æ–±–∞–∫–∞',  transcription: '[d…í…°]' },
    { word: 'house',  translation: '–¥–æ–º',     transcription: '[ha äs]' },
    { word: 'book',   translation: '–∫–Ω–∏–≥–∞',   transcription: '[b äk]' },
    { word: 'water',  translation: '–≤–æ–¥–∞',    transcription: '[Ààw…îÀêt…ô]' },
    { word: 'love',   translation: '–ª—é–±–æ–≤—å',  transcription: '[l åv]' },
    { word: 'friend', translation: '–¥—Ä—É–≥',    transcription: '[frend]' },
    { word: 'time',   translation: '–≤—Ä–µ–º—è',   transcription: '[ta…™m]' },
    { word: 'food',   translation: '–µ–¥–∞',     transcription: '[fuÀêd]' }
  ];

  // –û–∑–≤—É—á–∫–∞ —Å–ª–æ–≤–∞
  function speakWord(word) {
    if ('speechSynthesis' in window) {
      const utterance = new SpeechSynthesisUtterance(word);
      utterance.lang = 'en-US';
      utterance.rate = 0.8;
      window.speechSynthesis.speak(utterance);
    }
  }

   function ExercisesApp() {
    const [words, setWords] = useState(() => {
      const external = (window.currentVocab || []).filter(w => w.word && w.translation);
      return external.length ? external : DEMO_WORDS;
    });

      useEffect(() => {
    function handleUpdate(e) {
      const v =
        (e.detail && e.detail.vocab) ||
        window.currentVocab ||
        [];
      setWords(v.length ? v : DEMO_WORDS);
    }

    window.addEventListener("pt-vocab-updated", handleUpdate);
    // –¥–µ—Ä–≥–∞–µ–º –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏, —á—Ç–æ–±—ã –≤–∑—è—Ç—å —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞
    handleUpdate({ detail: { vocab: window.currentVocab || [] } });

    return () => window.removeEventListener("pt-vocab-updated", handleUpdate);
  }, []);

    const [mode, setMode] = useState('menu');
    const [currentIndex, setCurrentIndex] = useState(0);
    const [score, setScore] = useState(0);
    const [streak, setStreak] = useState(0);
    const [flipped, setFlipped] = useState(false);
    const [userInput, setUserInput] = useState('');
    const [feedback, setFeedback] = useState(null);
    
  
    // ---------- –†–ï–ñ–ò–ú –ö–ê–†–¢–û–ß–ï–ö ----------
    const FlashcardsMode = () => {
      const currentWord = words[currentIndex];

      const handleNext = (isCorrect) => {
        if (isCorrect) {
          setScore(prev => prev + 10);
          setStreak(prev => prev + 1);
        } else {
          setStreak(0);
        }

        setFlipped(false);
        if (currentIndex < words.length - 1) {
          setCurrentIndex(prev => prev + 1);
        } else {
          setMode('results');
        }
      };

      return (
        <div className="space-y-6">
          <div className="flex items-center justify-between">
            <div className="text-sm font-medium text-gray-600">
              {currentIndex + 1} / {words.length}
            </div>
            <div className="flex items-center gap-4 text-xs">
              <div className="flex items-center gap-1 text-amber-600">
                <span>‚ö°</span>
                <span className="font-bold">{streak}</span>
              </div>
              <div className="flex items-center gap-1 text-purple-600">
                <span>‚òÖ</span>
                <span className="font-bold">{score}</span>
              </div>
            </div>
          </div>

          <div
            className="relative h-64 cursor-pointer"
            style={{ perspective: '1000px' }}
            onClick={() => setFlipped(f => !f)}
          >
            <div
              className="absolute inset-0 transition-all duration-500"
              style={{
                transformStyle: 'preserve-3d',
                transform: flipped ? 'rotateY(180deg)' : 'rotateY(0deg)'
              }}
            >
              {/* –õ–∏—Ü–µ–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ */}
              <div
                className="absolute inset-0 bg-gradient-to-br from-amber-400 to-orange-500 rounded-3xl shadow-xl flex flex-col items-center justify-center p-8"
                style={{ backfaceVisibility: 'hidden' }}
              >
                <button
                  className="absolute top-4 right-4 p-2 bg-white/20 rounded-full hover:bg-white/30"
                  onClick={(e) => {
                    e.stopPropagation();
                    speakWord(currentWord.word);
                  }}
                >
                  üîä
                </button>
                <div className="text-6xl font-bold text-white mb-4">
                  {currentWord.word}
                </div>
                <div className="text-lg text-white/80">
                  {currentWord.transcription}
                </div>
                <div className="absolute bottom-6 text-sm text-white/60">
                  –ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å
                </div>
              </div>

              {/* –û–±—Ä–∞—Ç–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ */}
              <div
                className="absolute inset-0 bg-gradient-to-br from-blue-400 to-purple-500 rounded-3xl shadow-xl flex flex-col items-center justify-center p-8"
                style={{
                  backfaceVisibility: 'hidden',
                  transform: 'rotateY(180deg)'
                }}
              >
                <div className="text-5xl font-bold text-white mb-8">
                  {currentWord.translation}
                </div>
                <div className="flex gap-4">
                  <button
                    onClick={(e) => {
                      e.stopPropagation();
                      handleNext(false);
                    }}
                    className="px-6 py-3 bg-white/20 hover:bg-white/30 rounded-2xl text-white font-medium flex items-center gap-2"
                  >
                    <span>‚úó</span>
                    <span>–ù–µ –∑–Ω–∞–ª</span>
                  </button>
                  <button
                    onClick={(e) => {
                      e.stopPropagation();
                      handleNext(true);
                    }}
                    className="px-6 py-3 bg-white/90 hover:bg-white rounded-2xl text-purple-600 font-medium flex items-center gap-2"
                  >
                    <span>‚úì</span>
                    <span>–ó–Ω–∞–ª!</span>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div className="h-2 bg-gray-200 rounded-full overflow-hidden">
            <div
              className="h-full bg-gradient-to-r from-amber-400 to-orange-500 transition-all"
              style={{ width: `${((currentIndex + 1) / words.length) * 100}%` }}
            />
          </div>
        </div>
      );
    };

// ---------- –†–ï–ñ–ò–ú MATCH (—Å–æ–µ–¥–∏–Ω–∏ –ø–∞—Ä—ã) ----------
const MatchMode = () => {
  // –°–æ–∑–¥–∞—ë–º –ø–∞—Ä—ã –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
  const [localMatchPairs, setLocalMatchPairs] = useState(() => {
    const shuffled = [...words].sort(() => Math.random() - 0.5).slice(0, 5);
    const pairs = [];
    shuffled.forEach(w => {
      pairs.push({ id: `en-${w.word}`, text: w.word, type: 'en', matched: false });
      pairs.push({ id: `ru-${w.word}`, text: w.translation, type: 'ru', matched: false });
    });
    return pairs.sort(() => Math.random() - 0.5);
  });

  const [localSelectedCards, setLocalSelectedCards] = useState([]);
  const [localFeedback, setLocalFeedback] = useState(null);

  const handleCardClick = (card) => {
    if (card.matched) return;

    if (localSelectedCards.length === 0) {
      setLocalSelectedCards([card]);
    } else if (localSelectedCards.length === 1) {
      const first = localSelectedCards[0];
      
      const isMatch =
        first.id.split('-')[1] === card.id.split('-')[1] &&
        first.type !== card.type;

      if (isMatch) {
        setScore(prev => prev + 20);
        setStreak(prev => prev + 1);
        setLocalMatchPairs(prevPairs =>
          prevPairs.map(p =>
            p.id === first.id || p.id === card.id
              ? { ...p, matched: true }
              : p
          )
        );
        setLocalFeedback('correct');
      } else {
        setStreak(0);
        setLocalFeedback('incorrect');
      }

      setTimeout(() => {
        setLocalSelectedCards([]);
        setLocalFeedback(null);
        
        setLocalMatchPairs(prevPairs => {
          const allMatched = prevPairs.every(p => p.matched);
          if (allMatched) {
            setTimeout(() => setMode('results'), 500);
          }
          return prevPairs;
        });
      }, 600);
    }
  };

  return (
    <div className="space-y-6">
      <div className="flex items-center justify-between">
        <div className="text-lg font-bold text-gray-800">
          –°–æ–µ–¥–∏–Ω–∏ –ø–∞—Ä—ã
        </div>
        <div className="flex items-center gap-4 text-xs">
          <div className="flex items-center gap-1 text-amber-600">
            <span>‚ö°</span>
            <span className="font-bold">{streak}</span>
          </div>
          <div className="flex items-center gap-1 text-purple-600">
            <span>‚òÖ</span>
            <span className="font-bold">{score}</span>
          </div>
        </div>
      </div>

      <div className="grid grid-cols-2 gap-3">
        {localMatchPairs.map(card => (
          <button
            key={card.id}
            onClick={() => handleCardClick(card)}
            disabled={card.matched}
            className={
              'p-4 rounded-2xl font-medium transition-all ' +
              (card.matched
                ? 'bg-green-100 text-green-700 opacity-50'
                : localSelectedCards.some(c => c.id === card.id)
                  ? 'bg-amber-400 text-white scale-105 shadow-lg'
                  : 'bg-white hover:bg-gray-50 text-gray-800 border-2 border-gray-200')
            }
          >
            {card.text}
          </button>
        ))}
      </div>

      {localFeedback === 'correct' && (
        <div className="text-center text-green-600 font-bold animate-bounce">
          ‚úì –û—Ç–ª–∏—á–Ω–æ!
        </div>
      )}
      {localFeedback === 'incorrect' && (
        <div className="text-center text-red-600 font-bold" style={{ animation: 'shake 0.5s' }}>
          ‚úó –ù–µ —Å–æ–≤—Å–µ–º
        </div>
      )}
    </div>
  );
};


    // ---------- –†–ï–ñ–ò–ú TYPING ----------
    const TypingMode = () => {
      const currentWord = words[currentIndex];

      const handleCheck = () => {
        const isCorrect =
          userInput.toLowerCase().trim() === currentWord.word.toLowerCase();

        if (isCorrect) {
          setScore(prev => prev + 15);
          setStreak(prev => prev + 1);
          setFeedback('correct');
        } else {
          setStreak(0);
          setFeedback('incorrect');
        }

        setTimeout(() => {
          setUserInput('');
          setFeedback(null);
          if (currentIndex < words.length - 1) {
            setCurrentIndex(prev => prev + 1);
          } else {
            setMode('results');
          }
        }, 1000);
      };

      return (
        <div className="space-y-6">
          <div className="flex items-center justify-between">
            <div className="text-sm font-medium text-gray-600">
              {currentIndex + 1} / {words.length}
            </div>
            <div className="flex items-center gap-4 text-xs">
              <div className="flex items-center gap-1 text-amber-600">
                <span>‚ö°</span>
                <span className="font-bold">{streak}</span>
              </div>
              <div className="flex items-center gap-1 text-purple-600">
                <span>‚òÖ</span>
                <span className="font-bold">{score}</span>
              </div>
            </div>
          </div>

          <div className="bg-gradient-to-br from-purple-400 to-pink-500 rounded-3xl p-8 text-center">
            <button
              className="mb-4 p-3 bg-white/20 rounded-full hover:bg-white/30"
              onClick={() => speakWord(currentWord.word)}
            >
              üîä
            </button>
            <div className="text-4xl font-bold text-white mb-2">
              {currentWord.translation}
            </div>
            <div className="text-lg text-white/80">
              –ù–∞–ø–∏—à–∏ —Å–ª–æ–≤–æ –ø–æ-–∞–Ω–≥–ª–∏–π—Å–∫–∏
            </div>
          </div>

          <div className="space-y-4">
            <input
              type="text"
              value={userInput}
              onChange={(e) => setUserInput(e.target.value)}
              onKeyDown={(e) => {
                if (e.key === 'Enter' && userInput.trim() && !feedback) {
                  handleCheck();
                }
              }}
              placeholder="–í–≤–µ–¥–∏ —Å–ª–æ–≤–æ..."
              autoFocus
              className={
                'w-full px-6 py-4 text-2xl text-center rounded-2xl border-2 ' +
                'focus:outline-none focus:ring-4 transition-all ' +
                (feedback === 'correct'
                  ? 'border-green-500 bg-green-50 ring-green-200'
                  : feedback === 'incorrect'
                    ? 'border-red-500 bg-red-50 ring-red-200'
                    : 'border-gray-300 focus:border-purple-500 focus:ring-purple-200')
              }
            />

            {feedback === 'correct' && (
              <div className="text-center text-green-600 font-bold text-xl animate-bounce">
                ‚úì –ü—Ä–∞–≤–∏–ª—å–Ω–æ!
              </div>
            )}
            {feedback === 'incorrect' && (
              <div className="text-center space-y-2">
                <div
                  className="text-red-600 font-bold text-xl"
                  style={{ animation: 'shake 0.5s' }}
                >
                  ‚úó –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
                </div>
                <div className="text-gray-600">
                  –ü—Ä–∞–≤–∏–ª—å–Ω–æ: <span className="font-bold">{currentWord.word}</span>
                </div>
              </div>
            )}

            {!feedback && (
              <button
                onClick={handleCheck}
                disabled={!userInput.trim()}
                className="w-full py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold rounded-2xl hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed"
              >
                –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
              </button>
            )}
          </div>

          <div className="h-2 bg-gray-200 rounded-full overflow-hidden">
            <div
              className="h-full bg-gradient-to-r from-purple-400 to-pink-500 transition-all"
              style={{ width: `${((currentIndex + 1) / words.length) * 100}%` }}
            />
          </div>
        </div>
      );
    };

    // ---------- –≠–ö–†–ê–ù –†–ï–ó–£–õ–¨–¢–ê–¢–û–í ----------
    const ResultsScreen = () => {
      const maxPerWord = 15; // –≥—Ä—É–±–∞—è –æ—Ü–µ–Ω–∫–∞
      const percentage = Math.round((score / (words.length * maxPerWord)) * 100);

      return (
        <div className="text-center space-y-6">
          <div className="text-6xl mb-4">üéâ</div>
          <h2 className="text-3xl font-bold text-gray-800">–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!</h2>

          <div className="bg-gradient-to-br from-amber-400 to-orange-500 rounded-3xl p-8 text-white">
            <div className="text-6xl font-bold mb-2">{score}</div>
            <div className="text-xl opacity-90">–æ—á–∫–æ–≤ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</div>
          </div>

          <div className="grid grid-cols-2 gap-4">
            <div className="bg-gray-50 rounded-2xl p-4">
              <div className="text-3xl font-bold text-gray-800">{words.length}</div>
              <div className="text-sm text-gray-600">—Å–ª–æ–≤ –∏–∑—É—á–µ–Ω–æ</div>
            </div>
            <div className="bg-gray-50 rounded-2xl p-4">
              <div className="text-3xl font-bold text-gray-800">{percentage}%</div>
              <div className="text-sm text-gray-600">–ø—Ä–∏–º–µ—Ä–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å</div>
            </div>
          </div>

          <button
            onClick={() => {
              setMode('menu');
              setCurrentIndex(0);
              setScore(0);
              setStreak(0);
              setFlipped(false);
              setUserInput('');
              setFeedback(null);
              
            }}
            className="w-full py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold rounded-2xl hover:shadow-lg transition-all"
          >
            –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é
          </button>
        </div>
      );
    };

    // ---------- –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ ----------
    const MainMenu = () => {
      const modes = [
        {
          id: 'flashcards',
          title: '–ö–∞—Ä—Ç–æ—á–∫–∏',
          description: '–ü—Ä–æ–≤–µ—Ä—å, –ø–æ–º–Ω–∏—à—å –ª–∏ —Ç—ã —Å–ª–æ–≤–∞',
          icon: 'üÉè',
          color: 'from-amber-400 to-orange-500'
        },
        {
          id: 'match',
          title: '–°–æ–µ–¥–∏–Ω–∏ –ø–∞—Ä—ã',
          description: '–ù–∞–π–¥–∏ —Å–ª–æ–≤–æ –∏ –µ–≥–æ –ø–µ—Ä–µ–≤–æ–¥',
          icon: 'üéØ',
          color: 'from-blue-400 to-purple-500'
        },
        {
          id: 'typing',
          title: '–ù–∞–ø–∏—à–∏ —Å–ª–æ–≤–æ',
          description: '–í—Å–ø–æ–º–Ω–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ',
          icon: '‚úçÔ∏è',
          color: 'from-purple-400 to-pink-500'
        }
      ];

      return (
        <div className="space-y-6">
          <div className="text-center mb-8">
            <h2 className="text-3xl font-bold text-gray-800 mb-2">
              –í—ã–±–µ—Ä–∏ —Ä–µ–∂–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∏
            </h2>
            <p className="text-gray-600">
              –ò–∑—É—á–µ–Ω–æ —Å–ª–æ–≤: {words.length}
            </p>
          </div>

          <div className="grid gap-4">
            {modes.map(modeItem => (
              <button
                key={modeItem.id}
                onClick={() => {
                  setMode(modeItem.id);
                  setCurrentIndex(0);
                  setScore(0);
                  setStreak(0);
                  setFlipped(false);
                  setUserInput('');
                  setFeedback(null);
                  
                }}
                className={
                  'bg-gradient-to-r ' +
                  modeItem.color +
                  ' rounded-3xl p-6 text-white text-left ' +
                  'hover:shadow-xl hover:scale-105 transition-all'
                }
              >
                <div className="flex items-start gap-4">
                  <div className="text-5xl">{modeItem.icon}</div>
                  <div className="flex-1">
                    <h3 className="text-2xl font-bold mb-2">{modeItem.title}</h3>
                    <p className="text-white/90">{modeItem.description}</p>
                  </div>
                </div>
              </button>
            ))}
          </div>

          <div className="bg-gray-50 rounded-2xl p-6 text-center">
            <p className="text-sm text-gray-600 mb-2">üí° –°–æ–≤–µ—Ç –¥–Ω—è</p>
            <p className="text-gray-800">
              –ó–∞–Ω–∏–º–∞–π—Ç–µ—Å—å –ø–æ 5‚Äì10 –º–∏–Ω—É—Ç –∫–∞–∂–¥—ã–π –¥–µ–Ω—å ‚Äî —ç—Ç–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ, —á–µ–º —Ä–µ–¥–∫–∏–µ –¥–æ–ª–≥–∏–µ —Å–µ—Å—Å–∏–∏.
            </p>
          </div>
        </div>
      );
    };

    return (
      <div className="max-w-2xl mx-auto p-4">
        {/* –ê–Ω–∏–º–∞—Ü–∏—è shake –¥–ª—è –æ—à–∏–±–æ–∫ */}
        <style>{`
          @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
          }
        `}</style>

        {mode === 'menu'      && <MainMenu />}
        {mode === 'flashcards'&& <FlashcardsMode />}
        {mode === 'match'     && <MatchMode />}
        {mode === 'typing'    && <TypingMode />}
        {mode === 'results'   && <ResultsScreen />}
      </div>
    );
  }

  // –ú–æ–Ω—Ç–∏—Ä—É–µ–º React –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–∞–∫—Ç–∏–∫–∏
  const rootEl = document.getElementById('practice-react-root');
  if (rootEl && window.ReactDOM && ReactDOM.createRoot) {
    const root = ReactDOM.createRoot(rootEl);
    root.render(<ExercisesApp />);
  }
</script>

</body>
</html>
